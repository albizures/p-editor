!function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return t[n].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";i(1),window.hasVal=function(t){return"undefined"!=typeof t&&null!==t},window.$=i(7),i(19),i(20)},function(t,e,i){var n=i(2);"string"==typeof n&&(n=[[t.id,n,""]]);i(6)(n,{});n.locals&&(t.exports=n.locals)},function(t,e,i){e=t.exports=i(3)(),e.i(i(4),""),e.push([t.id,"*{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}::-webkit-scrollbar{width:10px;height:10px}::-webkit-scrollbar-thumb{background:hsla(0,0%,100%,.5)}::-webkit-scrollbar-track{background:rgba(0,0,0,.5)}canvas{image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:-o-crisp-edges;image-rendering:pixelated;-ms-interpolation-mode:nearest-neighbor}body{background:gray;position:absolute;width:100%;height:100%;overflow:hidden}.list{position:relative;list-style:none;box-sizing:border-box;padding:30px;margin:0}.panel-colorpicker .color{vertical-align:top;margin:3px;margin-top:6px}.canvas-picker{display:inline-block}.canvas-picker .content-canvas{display:inline-block;position:relative}.canvas-picker .content-canvas .canvas-picker{top:0;left:0;position:absolute;border-radius:100%;height:8px;width:8px;pointer-events:none;border:2px solid #fff;box-sizing:border-box;box-shadow:0 0 3px #000}.canvas-picker .content-rainbow{display:inline-block;position:relative}.canvas-picker .content-rainbow .rainbow-picker{pointer-events:none;top:0;left:-3px;position:absolute;width:100%;border:2px solid #fff;height:4px}body>.mask{pointer-events:none}.content-preview-animate,body>.canvas,body>.mask,body>.preview{position:absolute;top:0;left:0}.backdrop-context-menu{width:100%;height:100%;position:fixed;z-index:11;display:none}.backdrop-context-menu.active{display:block}.context-menu.list-menus{height:auto;border:1px solid gray;position:fixed;display:none;min-width:150px;background:#f5f5f5;z-index:12;box-shadow:3px 3px 2px rgba(0,0,0,.5);list-style:none;margin:0;padding:3px 0}.context-menu.list-menus>.menu{width:100%}.context-menu.list-menus .context-item{padding:0;cursor:pointer}.context-menu.list-menus.active{display:block}.content-preview-animate{left:auto;right:0}.panel.panel-float{box-shadow:3px 3px 3px rgba(0,0,0,.3)}.panel.panel-modal{background:rgba(0,0,0,.5);width:100%;border:0;position:fixed;left:0}.panel.panel-modal .body{box-shadow:0 3px 6px rgba(0,0,0,.16),0 3px 6px rgba(0,0,0,.23);margin:auto;margin-top:5%;background:#f5f5f5;padding:5px}.panel{position:absolute;overflow:hidden;box-sizing:border-box;border:2px solid hsla(0,0%,96%,.7);z-index:1;background:rgba(0,0,0,.5)}.panel .drag-bar{font-size:15px;text-align:center;background:#f5f5f5;width:100%;cursor:move}.panel .resize-bar{background:rgba(255,0,0,.1);position:absolute}.panel .resize-bar.B,.panel .resize-bar.T{height:6px;width:100%;cursor:n-resize}.panel .resize-bar.T,.panel .resize-bar.TL,.panel .resize-bar.TR{top:-6px}.panel .resize-bar.B,.panel .resize-bar.BL,.panel .resize-bar.BR{bottom:-6px}.panel .resize-bar.L,.panel .resize-bar.R{cursor:e-resize;width:6px;height:100%}.panel .resize-bar.BL,.panel .resize-bar.L,.panel .resize-bar.TL{left:-6px}.panel .resize-bar.BR,.panel .resize-bar.R,.panel .resize-bar.TR{right:-6px}.panel .resize-bar.BL,.panel .resize-bar.BR,.panel .resize-bar.TL,.panel .resize-bar.TR{height:6px;width:6px}.panel .resize-bar.TR{cursor:ne-resize}.panel .resize-bar.TL{cursor:nw-resize}.panel .resize-bar.BR{cursor:se-resize}.panel .resize-bar.BL{cursor:sw-resize}.panel-menus{border:0;box-shadow:0 1px 3px rgba(0,0,0,.12),0 1px 2px rgba(0,0,0,.24);z-index:10;transition:.3s height;background:#f5f5f5}.panel-menus.down{box-shadow:0 3px 6px rgba(0,0,0,.16),0 3px 6px rgba(0,0,0,.23)}.panel-menus .center{width:20%;display:inline-block;margin:auto}.panel-menus .center input{background:transparent;text-align:center;border:0}.panel-menus .center input:active,.panel-menus .center input:focus{border-bottom:1px solid gray;outline:none}.panel-tools .colors{margin:5px;position:relative;height:50px}.panel-tools .colors div{position:absolute;cursor:pointer}.panel-tools .colors .primary{box-shadow:0 0 5px rgba(0,0,0,.7);top:0;left:0}.panel-tools .colors .secondary{right:0;bottom:0}.color{background-size:40%;display:inline-block;cursor:pointer;position:relative}.color div{position:absolute;width:100%;height:100%}.color div.active{transform:scale(1.1);box-shadow:0 0 5px rgba(0,0,0,.7);transform-origin:50%}.panel.panel-frames{background:#f5f5f5;z-index:2;top:0;left:0;height:80%;width:120px}.panel.panel-frames button.add-frame{width:94%;margin:3%}.panel.panel-frames ul{overflow-y:scroll;height:calc(100% - 53px)}.panel.panel-frames ul li{transition:.3s top,.1s transform;border:1px solid;width:100%;box-shadow:0 1px 3px rgba(0,0,0,.12),0 1px 2px rgba(0,0,0,.24)}.panel.panel-frames ul li.drag{z-index:1;box-shadow:0 3px 6px rgba(0,0,0,.16),0 3px 6px rgba(0,0,0,.23);transition:.1s transform,0s top;transform:scale(1.07);background:rgba(0,0,0,.6)}.panel.panel-frames ul li.drag *{opacity:.4}.preview-frame{cursor:move;position:relative}.preview-frame canvas{position:absolute;top:0}.preview-frame .btn,.preview-frame .index{position:absolute;width:20px;height:20px}.preview-frame .index{bottom:0;right:0}.preview-frame .btn{opacity:0;transition:opacity .3s;font-size:.65em;top:0;left:0}.preview-frame .btn-clone{left:20px}.preview-frame .btn-hidden{left:40px}.preview-frame:hover .btn{opacity:1}.preview-frame.active{outline:2px solid #ff0}.panel.panel-layers{background:#f5f5f5}.panel.panel-layers button.add-layer{width:94%;margin:3%}.panel.panel-layers .layers-list{height:calc(100% - 53px);overflow-y:scroll}.preview-layer{transition:.3s top,.1s transform;border:1px solid;box-shadow:0 1px 3px rgba(0,0,0,.12),0 1px 2px rgba(0,0,0,.24);cursor:move;position:relative}.preview-layer.drag{z-index:1;box-shadow:0 3px 6px rgba(0,0,0,.16),0 3px 6px rgba(0,0,0,.23);transition:.1s transform,0s top;transform:scale(1.07);background:rgba(0,0,0,.6)}.preview-layer.drag *{opacity:.4}.preview-layer canvas{position:absolute;top:0}.preview-layer .btn,.preview-layer .index{position:absolute;width:20px;height:20px}.preview-layer .index{bottom:0;right:0}.preview-layer .btn{opacity:0;transition:opacity .3s;font-size:.65em;top:0;left:0}.preview-layer .btn-clone{left:20px}.preview-layer .btn-hidden{left:40px}.preview-layer:hover .btn{opacity:1}.preview-layer.active{outline:2px solid #ff0}.panel-preview{width:200px;right:0;top:0}.panel-preview .content-preview{position:relative;width:100%;height:calc(100% - 40px)}.panel-preview .content-preview .preview{position:absolute;top:0;left:0;cursor:pointer}.panel-preview .content-preview .area-preview{position:absolute;left:0;width:100%;height:100%;top:0;box-sizing:border-box;border:1px solid #000}.panel-actions .content-redo,.panel-actions .content-undo{width:50%;padding:5px;display:inline-block;box-sizing:border-box}.panel-actions .content-redo button,.panel-actions .content-undo button{width:100%;text-align:center}.panel-actions .content-redo{padding-left:0}.panel-actions .content-lists{overflow-y:scroll;height:calc(100% - 53px)}.panel-actions .content-lists .list-redo,.panel-actions .content-lists .list-undo{list-style:none;margin:0}.panel-actions .content-lists .list-undo{background:gray}.panel-actions .content-lists .list-redo{background:#fff}.content-panel-tab{margin:0;display:inline-block;text-align:center;background:#f5f5f5;box-sizing:border-box;box-shadow:inset 0 0 10px rgba(0,0,0,.5)}.content-panel-tab.active{box-shadow:inset 0 0 0 rgba(0,0,0,.5)}.panel-menus.panel{overflow:visible}.panel-menus.panel .name-project{float:right;background:transparent;border:0;text-align:right}.panel-menus.panel .logo{background:gray;width:25px;height:25px;display:inline-block}.list-menus{height:100%;vertical-align:top;margin:0;padding:0;display:inline-block;list-style:none}.list-menus li,.list-menus ul{margin:0;padding:0;box-sizing:border-box}.list-menus li{line-height:1.5}.list-menus li:hover{background:#a3c4ff;cursor:pointer}.list-menus .menu{background:#f5f5f5;height:100%;float:left;position:relative;margin:0;padding:0;white-space:nowrap;width:auto;padding:0 5px;list-style:none}.list-menus .menu .list-menus{border:1px solid gray;box-shadow:0 0 3px rgba(0,0,0,.2);background:#f5f5f5;position:absolute;top:100%;left:0;display:none;list-style:none}.list-menus .menu .list-menus .menu{padding:2px 4px;height:100%;width:100%;position:relative}.list-menus .menu .list-menus .menu .list-menus{left:100%;top:0}.list-menus .menu .list-menus .menu:hover>.list-menus,.list-menus .menu:hover>.list-menus{display:inline-block}.panel-resize{background:#f5f5f5}.resize-grid{width:65px;height:65px;margin:5px auto;overflow:hidden}.resize-grid .resize-cell{display:inline-block;width:20px;height:20px;background:hsla(0,0%,50%,.7);margin:0 0 1px 1px;float:left;position:relative}.resize-grid .resize-cell.active{background:#a3c4ff;z-index:2}.resize-grid .resize-cell.active span{position:absolute;border:10px solid transparent;pointer-events:none;transform:scale(.7)}.resize-grid .resize-cell.active span:nth-child(1){top:-25px;border-bottom:10px solid #a3c4ff}.resize-grid .resize-cell.active span:nth-child(2){right:-25px;border-left:10px solid #a3c4ff}.resize-grid .resize-cell.active span:nth-child(3){bottom:-25px;border-top:10px solid #a3c4ff}.resize-grid .resize-cell.active span:nth-child(4){left:-25px;border-right:10px solid #a3c4ff}.panel-palette{background:#f5f5f5}.panel-palette .input-color{background-image:url("+i(5)+");background-size:7%}.panel-palette .picker input[type=range]{width:70%}.panel-palette .palette{overflow-y:scroll;height:calc(100% - 25px)}.panel-palette .palette .color{margin:1px;float:left}.panel-palettes{background:#f5f5f5}.panel-palettes .content-palettes .palette{padding:2px;margin:2px;cursor:pointer}.panel-palettes .content-palettes .palette.active,.panel-palettes .content-palettes .palette:hover{background:#e3e3e3}.panel-palettes .content-palettes .palette .color{vertical-align:top;pointer-events:none;margin-right:1px}",""])},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var i=this[e];i[2]?t.push("@media "+i[2]+"{"+i[1]+"}"):t.push(i[1])}return t.join("")},t.i=function(e,i){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},s=0;s<this.length;s++){var a=this[s][0];"number"==typeof a&&(n[a]=!0)}for(s=0;s<e.length;s++){var o=e[s];"number"==typeof o[0]&&n[o[0]]||(i&&!o[2]?o[2]=i:i&&(o[2]="("+o[2]+") and ("+i+")"),t.push(o))}},t}},function(t,e,i){e=t.exports=i(3)(),e.push([t.id,"/*! normalize.css v3.0.2 | MIT License | git.io/normalize */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}",""])},function(t,e,i){t.exports=i.p+"/assets/images/transparent.png"},function(t,e,i){function n(t,e){for(var i=0;i<t.length;i++){var n=t[i],s=u[n.id];if(s){s.refs++;for(var a=0;a<s.parts.length;a++)s.parts[a](n.parts[a]);for(;a<n.parts.length;a++)s.parts.push(l(n.parts[a],e))}else{for(var o=[],a=0;a<n.parts.length;a++)o.push(l(n.parts[a],e));u[n.id]={id:n.id,refs:1,parts:o}}}}function s(t){for(var e=[],i={},n=0;n<t.length;n++){var s=t[n],a=s[0],o=s[1],r=s[2],h=s[3],l={css:o,media:r,sourceMap:h};i[a]?i[a].parts.push(l):e.push(i[a]={id:a,parts:[l]})}return e}function a(t,e){var i=g(),n=b[b.length-1];if("top"===t.insertAt)n?n.nextSibling?i.insertBefore(e,n.nextSibling):i.appendChild(e):i.insertBefore(e,i.firstChild),b.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");i.appendChild(e)}}function o(t){t.parentNode.removeChild(t);var e=b.indexOf(t);e>=0&&b.splice(e,1)}function r(t){var e=document.createElement("style");return e.type="text/css",a(t,e),e}function h(t){var e=document.createElement("link");return e.rel="stylesheet",a(t,e),e}function l(t,e){var i,n,s;if(e.singleton){var a=y++;i=m||(m=r(e)),n=c.bind(null,i,a,!1),s=c.bind(null,i,a,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=h(e),n=p.bind(null,i),s=function(){o(i),i.href&&URL.revokeObjectURL(i.href)}):(i=r(e),n=d.bind(null,i),s=function(){o(i)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else s()}}function c(t,e,i,n){var s=i?"":n.css;if(t.styleSheet)t.styleSheet.cssText=w(e,s);else{var a=document.createTextNode(s),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(a,o[e]):t.appendChild(a)}}function d(t,e){var i=e.css,n=e.media;e.sourceMap;if(n&&t.setAttribute("media",n),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}function p(t,e){var i=e.css,n=(e.media,e.sourceMap);n&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var s=new Blob([i],{type:"text/css"}),a=t.href;t.href=URL.createObjectURL(s),a&&URL.revokeObjectURL(a)}var u={},f=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},v=f(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),g=f(function(){return document.head||document.getElementsByTagName("head")[0]}),m=null,y=0,b=[];t.exports=function(t,e){e=e||{},"undefined"==typeof e.singleton&&(e.singleton=v()),"undefined"==typeof e.insertAt&&(e.insertAt="bottom");var i=s(t);return n(i,e),function(t){for(var a=[],o=0;o<i.length;o++){var r=i[o],h=u[r.id];h.refs--,a.push(h)}if(t){var l=s(t);n(l,e)}for(var o=0;o<a.length;o++){var h=a[o];if(0===h.refs){for(var c=0;c<h.parts.length;c++)h.parts[c]();delete u[h.id]}}}};var w=function(){var t=[];return function(e,i){return t[e]=i,t.filter(Boolean).join("\n")}}()},function(t,e,i){"use strict";var n=i(8),s=i(9),a=function(){if(0!==arguments.length){if(arguments[0]instanceof n)return arguments[0];var t=arguments;if(t[0]instanceof Element||t[0]===window)return new n(t[0]);if(t[0]instanceof s)return new n(t[0].el);if("string"==typeof t[0]){var e=t[0].trim(),i=void 0,a=!0;return a==e.indexOf(" ")!==-1&&a,a==e.split(".").length>1&&a,a==e.indexOf(">")!==-1&&a,a==e.indexOf(",")!==-1&&a,a?-1!==e.indexOf("#")?i=document.getElementById(e.replace("#","")):-1!==e.indexOf(".")&&(i=document.getElementsByClassName(e.replace(".","")),console.log(i,e)):console.log("query select"),new n(i)}}};t.exports=a},function(t,e){"use strict";function i(){if(1===arguments.length&&arguments[0]&&arguments[0].length)for(var t=0;t<arguments[0].length;t++)hasVal(arguments[0][t])&&this.push(arguments[0][t]);else for(var e=0;e<arguments.length;e++)hasVal(arguments[e])&&this.push(arguments[e])}function n(t,e,i){var n=window===this[0]?"inner":i?"client":"offset";if(!hasVal(e))return this[0][n+t];if("number"==typeof e)for(var s="px",a=0;a<this.length;a++)this[a].style.width=e+s}i.prototype=Object.create(Array.prototype),i.prototype.width=function(t){return n.bind(this)("Width",t)},i.prototype.height=function(t){return n.bind(this)("Height",t)},i.prototype.contentWidth=function(t){return n.bind(this)("Width",t,!0)},i.prototype.contentHeight=function(t){return n.bind(this)("Height",t,!0)},i.prototype.on=function(t,e){var i=t.split(".")[1];t=t.split(".")[0];for(var n=0;n<this.length;n++){if(hasVal(this[n]._events)||Object.defineProperty(this[n],"_events",{value:{},enumerable:!1}),!hasVal(i))return console.error("Event error name");hasVal(this[n]._events[t])||(this[n]._events[t]={}),hasVal(this[n]._events[t][i])?(console.log(this[n]._events[t][i]),console.error("Event wrong name",arguments)):(this[n]._events[t][i]=e.bind(this[n]),this[n].addEventListener(t,this[n]._events[t][i]))}return this},i.prototype.off=function(t){var e=t.split(".")[1];t=t.split(".")[0];for(var i=0;i<this.length;i++)if(hasVal(e))hasVal(this[i]._events)&&hasVal(this[i]._events[t])&&hasVal(this[i]._events[t][e])&&(this[i].removeEventListener(t,this[i]._events[t][e]),delete this[i]._events[t][e]);else if(hasVal(this[i]._events[t])){for(var n in this[n]._events[t])this[n].removeEventListener(t,this[n]._events[t][n]);delete this[i]._events[t]}else for(var s in this[s]._events)hasVal(this[s]._events[s][t])&&(this[s].removeEventListener(s,this[s]._events[s][t]),delete this[s]._events[s][t]);return this},i.prototype.append=function(t){for(var e=0;e<this.length;e++)if(t instanceof Element)this[e].appendChild(t);else for(var i=0;i<t.length;i++)t[i]instanceof Element&&this[e].appendChild(t[i]);return this},t.exports=i},function(t,e,i){"use strict";function n(){this.el=document.createElement(this.$type);for(var t=0;t<arguments.length;t++)this.el.classList.add(arguments[t])}var s=i(10),a=s.defineGetter;a(n.prototype,"parent",function(){return this.el.parentNode}),n.prototype.on=function(t,e){$(this.el).on(t,e)},n.prototype.appendTo=function(t){return t.appendChild(this.el),this},n.prototype.remove=function(){this.el.remove()},n.prototype.addClass=function(t){return this.el.classList.add(t),this},n.prototype.removeClass=function(t){return this.el.classList.remove(t),this},n.prototype.$type="div",t.exports=n},function(t,e,i){"use strict";function n(t){var e=document.createElement("span");e.textContent=t;for(var i=Array.prototype.slice.call(arguments,1),n=0;n<i.length;n++)e.classList.add(i[n]);return e}function s(t){var e=document.createElement("button");e.textContent=t;for(var i=Array.prototype.slice.call(arguments,1),n=0;n<i.length;n++)e.classList.add(i[n]);return e}function a(){for(var t=document.createElement("div"),e=0;e<arguments.length;e++)t.classList.add(arguments[e]);return t}function o(t,e,i){var n=document.createElement("input");n.type="range",n.value=t,n.min=e,n.max=i;for(var s=Array.prototype.slice.call(arguments,2),a=0;a<s.length;a++)n.classList.add(s[a]);return n}function r(t,e){var i=window.saveAs||navigator.msSaveBlob&&navigator.msSaveBlob.bind(navigator);if(i)i(t,e);else{t=window.URL.createObjectURL(t);var n=c("a",{parent:document.body,href:t,download:e});n.click(),n.remove()}}function h(t,e,i){Object.defineProperty(t,e,{get:i,enumerable:!0,configurable:!0})}function l(t){return"object"===("undefined"==typeof HTMLElement?"undefined":d(HTMLElement))?t instanceof HTMLElement:t&&"object"===("undefined"==typeof t?"undefined":d(t))&&null!==t&&1===t.nodeType&&"string"==typeof t.nodeName}function c(t){if(!Array.isArray(t))return c.call(this,Array.prototype.slice.call(arguments));var e=t[0],i=!1,n=t[1],s="string"==typeof e?document.createElement(e):e,a=1;if("object"===("undefined"==typeof n?"undefined":d(n))&&null!==n&&!Array.isArray(n)&&!l(n)){for(var o in n)"parent"===o?i=!0:s[o]=n[o];a=2}for(var r=a;r<t.length;r++)l(t[r])?s.appendChild(t[r]):Array.isArray(t[r])?s.appendChild(c(t[r])):s.appendChild(document.createTextNode(t[r]));return i&&n.parent.appendChild(s),s}var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},p=function(t,e){t.imageSmoothingEnabled=e,t.mozImageSmoothingEnabled=e,t.msImageSmoothingEnabled=e};t.exports={make:c,defineGetter:h,imageSmoothing:p,createBtn:s,createSpan:n,createDiv:a,createInputRange:o,imageSmoothingDisabled:function(t){p(t,!1)},downloadBlob:r,inheritanceObject:function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t}},t.exports.colors=i(11),t.exports.browser=i(18)},function(t,e,i){"use strict";function n(t,e,i){var n=1-(.299*t+.587*e+.114*i)/255;return console.log(n),.5>n}var s=i(12).colors;s.HEX,s.RGBA_PER,s.RGBA,s.ABBR_HEX,s.NAC,s.DEFAULT_COLOR,s.HSL;t.exports={colorIsLight:n}},function(t,e,i){"use strict";var n=document.createElement("img"),s=document.createElement("img"),a=document.createElement("img"),o=document.createElement("canvas").getContext("2d"),r=.3;n.addEventListener("load",function(){var t=o.canvas.width=this.width*r,e=o.canvas.height=this.height*r;o.drawImage(this,0,0,this.width,this.height,0,0,t,e)}),o.canvas.img=n,a.src=i(13),s.src=i(14),n.src=i(5),t.exports={GRADIENT:s,RAINBOW:a,HEIGHT_DEF:20,WIDTH_DEF:20,SCALE_DEF:10,TRANSPARENT_IMG_URL:i(5),TRANSPARENT_IMG:o.canvas,TRANSPARENT_COLOR:"rgba(0, 0, 0, 0)",TRANSPARENT_COLOR_VALUE:"",SIZE_POINTER_DEF:1,COLOR_POINTER_PREW_DEF:"rgba(255, 255, 255, 0.6)",SECOND_COLOR_POINTER_PREW_DEF:"rgba(0, 0, 0, 0.2)",RIGHT_CLICK:3,LEFT_CLICK:1,MIDDLE_CLICK:2,PALETTE:"Palette",FRAMES:"Frames"},t.exports.colors={DEFAULT_COLOR:"#000",RGBA:"rgba",RGBA_PER:"rgbaPer",ABBR_HEX:"abbrHex",HEX:"hex",HSL:"hsl",NAC:"NaC"},t.exports.palette=i(15),t.exports.events=i(16),t.exports.actions=i(17)},function(t,e,i){t.exports=i.p+"/assets/images/rainbow.png"},function(t,e,i){t.exports=i.p+"/assets/images/gradient.png"},function(t,e){"use strict";t.exports={SIZE_COLOR_BLOCK:20,CHANGE_COLOR:"changeColor"},t.exports.picker={R:"R",G:"G",B:"B",A:"A"}},function(t,e){"use strict";t.exports={CHANGE_SPRITE:"changeSprite",ADD_FRAME:"addFrame",DELETE_FRAME:"deleteFrame",UPDATE_FRAME:"updateFrame",SELECT_FRAME:"selectFrame",ADD_LAYER:"addLayer",DELETE_LAYER:"deleteLayer",UPDATE_LAYER:"updateLayer",SELECT_LAYER:"selectLayer",SELECT_TOOL:"selectTool",RESIZE_PANEL:"resizePanel"}},function(t,e){"use strict";t.exports={PAINT:"paint"}},function(t,e){"use strict";var i=navigator.platform.toLowerCase(),n=navigator.userAgent.toLowerCase(),s=n.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],a="ie"===s[1]&&document.documentMode,o={name:"version"===s[1]?s[3]:s[1],version:a||parseFloat("opera"===s[1]&&s[4]?s[4]:s[2]),platform:{name:n.match(/ip(?:ad|od|hone)/)?"ios":(n.match(/(?:webos|android)/)||i.match(/mac|win|linux/)||["other"])[0]}};o[o.name]=!0,o[o.name+parseInt(o.version,10)]=!0,o.platform[o.platform.name]=!0,t.exports=o},function(t,e){"use strict";Array.prototype.fill||(Array.prototype.fill=function(t){if(null==this)throw new TypeError("this is null or not defined");for(var e=Object(this),i=e.length>>>0,n=arguments[1],s=n>>0,a=0>s?Math.max(i+s,0):Math.min(s,i),o=arguments[2],r=void 0===o?i:o>>0,h=0>r?Math.max(i+r,0):Math.min(r,i);h>a;)e[a]=t,a++;return e})},function(t,e,i){"use strict";var n=i(21),s=i(50),a=i(34),o=i(58),r=i(59),h=i(56),l=i(67),c=i(52),d=i(55),p=i(68),u=i(27),f=i(26),v=i(47),g=i(69),m=i(70),y=i(71),b=i(73),w=i(74),x=i(75),C=i(76),k=i(77),E=i(78);window.onload=function(){window.Editor=n,c.$add(),s.$add(),a.$add(),f.$add(),h.$add(),d.$add(),o.$add(),l.$add(),p.$add(),v.$add(),u.$add(),g.$add(),r.$add(),m.$add(),E(),y(),b(),w(),x(),C(),k(),n.init()}},function(t,e,i){"use strict";var n=i(12),s=(n.SCALE_DEF,n.WIDTH_DEF),a=n.HEIGHT_DEF,o=(n.PALETTE,n.FRAMES,i(22)),r=i(23),h=r.SNAP,l=(r.FLOAT,r.B,r.L),c=r.R,d=r.TL,p=r.TR,u=r.BL,f=r.BR,v=i(12).events,g=(v.CHANGE_SPRITE,v.ADD_FRAME,v.SELECT_FRAME,v.RESIZE_PANEL,i(25)),m=i(43),y=i(37),b=i(24),w={panels:{},addPanel:function(t,e){e?(this.panels[t.name]=t,e.addPanel(t)):this.panels[t.name]=t.appendTo(document.body)},onResizePanel:function(t){t===l||t===d||t===u?this.onResizeL(arguments[1]):(t===c||t==p)&&this.onResizeR(arguments[1])},onResizeL:function(t){for(var e=Object.keys(this.panels),i=0;i<e.length;i++){var n=this.panels[e[i]];n.type!==h||n.position!==l&&n.position!==u&&n.position!==d||n.changeWidth(t)}},onResizeR:function(t){for(var e=Object.keys(this.panels),i=0;i<e.length;i++){var n=this.panels[e[i]];n.type!==h||n.position!==c&&n.position!==f&&n.position!==p||n.changeWidth(t)}},initPanels:function(){for(var t=0,e=Object.keys(this.panels);t<e.length;t++){var i=this.panels[e[t]];i.init()}},getRightPanels:function(){for(var t={height:0,panels:[]},e=0,i=Object.keys(this.panels);e<i.length;e++){var n=this.panels[i[e]];n.isRight()&&n.isInit&&(t.width||(t.width=n.width),t.height+=n.heightPerc,t.panels.push(n))}return t},getLeftPanels:function(){for(var t={height:0,panels:[]},e=0,i=Object.keys(this.panels);e<i.length;e++){var n=this.panels[i[e]];n.isLeft()&&n.isInit&&(t.width||(t.width=n.width),t.height+=n.heightPerc,t.panels.push(n))}return t},addTool:function(t){this.panels.Tools.addTool(t)},shortcuts:i(65),events:i(66),init:function(){this.shortcuts.init(),this.initPanels(),this.contextMenu.init()},timeoutGetTransparentColor:1,getTransparentColor:function(){function t(){i.timeoutGetTransparentColor=void 0,i.sprite.getTransparentColor(e)}function e(t){for(var e=0;e<i.callbacksGetColor.length;e++)i.callbacksGetColor[e](t);i.callbacksGetColor.length=0}var i=this;0==this.callbacksGetColor.length?this.timeoutGetTransparentColor?(clearTimeout(this.timeoutGetTransparentColor),this.timeoutGetTransparentColor=setTimeout(t,6e3)):this.timeoutGetTransparentColor=setTimeout(t,6e3):i.sprite.getTransparentColor(e)},getGeneralColors:function(){function t(t){this.panels.Palette.setCurretColors(t)}this.sprite.getGeneralColors(t.bind(this))},callbacksGetColor:[],addCallbackGetColor:function(t){this.callbacksGetColor.push(t),clearTimeout(this.timeoutGetTransparentColor),self.timeoutGetTransparentColor=void 0,this.getTransparentColor()},initSprite:function(t){var e,i,n,o,r,h,l,t=t||{},c=t.height||a,d=t.width||s,n=(window.innerHeight-this.panels.Menus.height)/c;i=this.getRightPanels().width,e=this.getLeftPanels().width,o=(window.innerWidth-e-i)/d,r=o>n?n:o,r=Math.round(.94*r),h=Math.round(window.innerWidth/2-r*d/2),l=Math.round((window.innerHeight+this.panels.Menus.height)/2-r*c/2),this.sprite=new m(d,c),this.canvas=new g(this.sprite.frames[0].layers[0],r,new b(h,l)),this.sprite.frames[0].select()},contextMenu:{init:function(){var t=this;this.context=y.createContext().appendTo(document.body),this.backdrop=o(["div",{parent:document.body,className:"backdrop-context-menu"}]),this.context.on("click.hide",function(e){e.stopPropagation(),t.hide()}),$(this.backdrop).on("click.hide",function(e){e.stopPropagation(),t.hide()}),this.show=this.show.bind(this)},show:function(){this.context.addClass("active"),this.backdrop.classList.add("active")},hide:function(){this.context.removeClass("active"),this.backdrop.classList.remove("active")},add:function(t){var e=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],i=this.onContextMenu.bind(t);return t.context=this.context,t.show=this.show,e||$(t.el).on("contextmenu.options",i),i},onContextMenu:function(t){console.log("onContextMenu"),this.context.setStructure(this.structure),this.context.el.style.top=t.clientY+"px",this.context.el.style.left=t.clientX+"px",this.show()}}};t.exports=w},function(t,e){"use strict";function i(t){return"object"===("undefined"==typeof HTMLElement?"undefined":n(HTMLElement))?t instanceof HTMLElement:t&&"object"===("undefined"==typeof t?"undefined":n(t))&&null!==t&&1===t.nodeType&&"string"==typeof t.nodeName}var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};t.exports=function s(t){if(!Array.isArray(t))return s.call(this,Array.prototype.slice.call(arguments));var e=t[0],a=!1,o=t[1],r="string"==typeof e?document.createElement(e):e,h=1;if("object"===("undefined"==typeof o?"undefined":n(o))&&null!==o&&!Array.isArray(o)&&!i(o)){for(var l in o)"parent"===l?a=!0:r[l]=o[l];h=2}for(var c=h;c<t.length;c++)i(t[c])?r.appendChild(t[c]):Array.isArray(t[c])?r.appendChild(s(t[c])):r.appendChild(document.createTextNode(t[c]));return a&&o.parent.appendChild(r),r}},function(t,e,i){"use strict";function n(t,e,i,n,s,a,o,r){l.call(this,"panel","panel-"+t.toLowerCase(),"panel-"+e),this.name=t,this.type=e,this.position=i||new c,this.snapType=a,this.notDragbar=o,this.hidden=r,this.width=n,this.height=s}var s=i(10),a=s.createDiv,o=s.createSpan,r=s.defineGetter,h=s.inheritanceObject,l=i(9),c=i(24);h(n,l),r(n.prototype,"layers",function(){return Editor.canvas.artboard.layer.frame.layers}),r(n.prototype,"frame",function(){return Editor.canvas.artboard.layer.frame}),r(n.prototype,"sprite",function(){return Editor.canvas.artboard.layer.frame.sprite}),n.SNAP="snap",n.MODAL="modal",n.FLOAT="float",n.T="T",n.B="B",n.L="L",n.R="R",n.TL="TL",n.TR="TR",n.BL="BL",n.BR="BR",n.M="M",n.prototype.hide=function(){this.el.style.opacity=0,this.el.style.pointerEvents="none"},n.prototype.show=function(t,e){this.el.style.width=t||this.el.style.width,this.el.style.height=e||this.el.style.height,this.el.style.opacity=1,this.el.style.pointerEvents="initial",this.onShow()},n.prototype.onShow=function(){},n.prototype.heightDragBar=20,n.prototype.init=function(t,e){if(this.hidden&&this.hide(),!hasVal(this.parent))return console.error("parent undefined");if(n.SNAP===this.type&&this.el.parentElement==document.body)this.setSnapPosition();else if(n.FLOAT===this.type)this.changeSize(this.width,this.height,this.position.x,this.position.y);else if(this.el.parentElement==document.body){100*Editor.panels.Menus.height/window.innerHeight;this.el.style.top=0,this.el.style.height="100%"}this.notDragbar||(this.dragBar=a("drag-bar"),this.dragBar.style.height=this.heightDragBar+"px",this.dragBar.appendChild(o(this.name)),this.el.appendChild(this.dragBar),$(this.dragBar).on("mousedown.drag",this.onDragStart.bind(this))),hasVal(this.mainInit)&&this.mainInit(),this.isInit=!0},n.prototype.isLeft=function(){return this.type===n.SNAP&&this.snapType===n.TL||this.snapType===n.BL||this.snapType==n.L},n.prototype.isRight=function(){return this.type===n.SNAP&&this.snapType===n.TR||this.snapType===n.BR||this.snapType==n.R},n.prototype.isBottom=function(){return this.type===n.SNAP&&this.snapType===n.BL||this.snapType===n.BR||this.snapType==n.B},n.prototype.isTop=function(){return this.type===n.SNAP&&this.snapType===n.TR||this.snapType===n.TL||this.snapType==n.T},n.prototype.setSnapPosition=function(){if(this.isLeft()||this.isRight()){this.el.style.width=this.width+"%";var t=100*Editor.panels.Menus.height/window.innerHeight;this.isLeft()?(this.el.style.left="0",this.isTop()?(this.position.y=t,this.el.style.top=t+"%",this.height-=t):this.el.style.top=this.position.y+"%"):this.isRight()&&(this.position.x=100-this.width,this.el.style.left=this.position.x+"%",
this.isTop()?(this.position.y=t,this.el.style.top=t+"%",this.height-=t):this.el.style.top=this.position.y+"%"),this.el.style.height=this.height+"%"}else this.el.style.width=this.width+"%","Menus"==this.name?this.el.style.height=this.height+"px":this.el.style.height=this.height+"%",this.isTop()?this.el.style.top=0:this.el.style.bottom=0},n.prototype.$add=function(){Editor.addPanel(this)},n.prototype.changePosition=function(t){t=t||this.position;var e=this.el.getBoundingClientRect();t.x<0&&(t.x=0),t.x+e.width>window.innerWidth&&(t.x=window.innerWidth-e.width),t.y<0&&(t.y=0),t.y+e.height>window.innerHeight&&(t.y=window.innerHeight-e.height),this.position=t,localStorage.setItem("panel-"+this.name.toLowerCase(),t.toString()),this.el.style.top=t.y+"px",this.el.style.left=t.x+"px"},n.prototype.onDragStart=function(t){this.type!==n.SNAP&&(this.offsetDrag=new c(t.offsetX,t.offsetY),$(window).off("mousemove.drag").on("mousemove.drag",this.onDrag.bind(this)).off("mouseup.drag").on("mouseup.drag",this.onDragEnd.bind(this)))},n.prototype.onDragEnd=function(t){$(window).off("mousemove.drag").off("mouseup.drag")},n.prototype.onDrag=function(t){var e=new c(t.clientX,t.clientY);e.less(this.offsetDrag),this.changePosition(e)},n.prototype.onResizeStart=function(t){$(window).off("mousemove.resize").on("mousemove.resize",this.onResize.bind(this)).off("mouseup.resize").on("mouseup.resize",this.onResizeEnd.bind(this)),this.typeResize=t.target.className.replace(/resize-bars|resize-corners/,"").trim()},n.prototype.onResize=function(t){this.type===n.SNAP&&this.typeResize==this.position},n.prototype.changeSize=function(t,e,i,n){t=t||this.width,e=e||this.height,i=i||this.position.x,n=n||this.position.y,this.minWidth&&e<this.minWidth&&(t=this.minWidth),this.minHeight&&e<this.minHeight&&(e=this.minHeight),0>i&&(i=0),0>n&&(n=0),i>window.innerWidth+t&&(i=window.innerWidth-t),n>window.innerHeight+e&&(n=window.innerHeight-e),this.position=new c(i,n),this.width=t,this.height=e,this.el.style.top=n+"px",this.el.style.left=i+"px",this.el.style.width=t+"px",this.el.style.height=e+"px"},n.prototype.onResizeEnd=function(t){$(window).off("mousemove.resize").off("mouseup.resize")},n.createFloatPanel=function(t,e,i,s,a){return new n(t,n.FLOAT,e,s,a,void 0,!1,i)},n.createModalPanel=function(t,e){return new n(t,n.MODAL,void 0,0,0,void 0,!0,e)},t.exports=n},function(t,e){"use strict";function i(t,e){this.x=t||0,this.y=e||0}var n,s=Math.abs;i.prototype.less=function(t,e){return 1==arguments.length&&(e=t.y,t=t.x),this.x-=t,this.y-=e,this},i.prototype.sum=function(t,e){return 1==arguments.length&&(e=t.y,t=t.x),this.x+=t,this.y+=e,this},i.prototype.toString=function(){return JSON.stringify(this)},i.prototype.diffAbs=function(t){return{x:s(this.x-t.x),y:s(this.y-t.y),sx:this.x<t.x?1:-1,sy:this.y<t.y?1:-1}},i.prototype.diff=function(t){return{x:this.x-t.x,y:this.y-t.y,sx:this.x<t.x?1:-1,sy:this.y<t.y?1:-1}},i.prototype.clone=function(){return new i(this.x,this.y)},i.prototype.equals=function(t){return this.x==t.x&&this.y==t.y},i.prototype.importantDiff=function(t){return n=this.diffAbs(t),n.x>1||n.y>1},t.exports=i},function(t,e,i){"use strict";function n(t,e,i,n){this.artboard=x,this.parent=document.body,this.artboard.scale=e||f,this.artboard.layer=t,this.artboard.cord=i,this.sizePointer=(n||v)*e,this.init()}var s=i(24),a=Math,o=a.floor,r=a.round,h=(i(26),i(34)),l=i(22),c=i(35),d=i(36),p=i(37),u=i(12),f=u.SCALE_DEF,v=u.SIZE_POINTER_DEF,g=u.MIDDLE_CLICK,m=u.TRANSPARENT_IMG,y=u.RIGHT_CLICK,b=u.LEFT_CLICK,w=$(window),x={get width(){return this.layer.width*this.scale},get height(){return this.layer.height*this.scale}};n.prototype={contructor:n,get tool(){return Editor.panels.Tools.currentTool}},n.prototype.init=function(){var t=this;this.background=l("canvas",{parent:this.parent,className:"background"}).getContext("2d"),this.main=l("canvas",{parent:this.parent,className:"canvas"}).getContext("2d"),this.preview=l("canvas",{parent:this.parent,className:"preview"}).getContext("2d"),this.mask=l("canvas",{parent:this.parent,className:"mask"}).getContext("2d"),m.img.addEventListener("load",this.paintBackground.bind(this)),$(this.preview.canvas).off("mousewheel.canvas").on("mousewheel.canvas",this.onScroll.bind(this)).off("DOMMouseScroll.canvas").on("DOMMouseScroll.canvas",this.onScroll.bind(this)).off("mousedown.canvas").on("mousedown.canvas",this.onMouseDown.bind(this)),this.contextMenu=Editor.contextMenu.add({el:this.preview.canvas,structure:[p.createMenu("Center",function(){return t.center()})]},!0),w.off("resize.canvas").on("resize.canvas",this.resize.bind(this)).off("mousemove.preview").on("mousemove.preview",this.onMouseMove.bind(this)),this.resize()},n.prototype.resize=function(){this.mask.canvas.width=this.background.canvas.width=this.main.canvas.width=this.preview.canvas.width=window.innerWidth,this.mask.canvas.height=this.background.canvas.height=this.main.canvas.height=this.preview.canvas.height=window.innerHeight,d(this.main,!1),d(this.preview,!1),d(this.background,!1),this.paintBackground(),this.paintMask(),this.paintMain()},n.prototype.changeLayer=function(t){this.artboard.layer=t,this.paintMain()};var C=void 0;n.prototype.onScroll=function(t){C||(C=setTimeout(function(){C=void 0;var e=1.06;return t.deltaY>0||t.detail>0?(e=.9,this.scaleTo(Math.floor(this.artboard.scale*e))):t.deltaY<0||t.detail<0?(e=1.1,this.scaleTo(Math.ceil(this.artboard.scale*e))):void 0}.bind(this),40))},n.prototype.scaleTo=function(t){1>t||(this.artboard.cord.x+=this.artboard.layer.width*this.artboard.scale/2,this.artboard.cord.y+=this.artboard.layer.height*this.artboard.scale/2,this.sizePointer=this.sizePointer/this.artboard.scale*t,this.artboard.scale=t,this.cleanPrev(),this.artboard.cord.x=this.artboard.cord.x-this.artboard.layer.width*this.artboard.scale/2,this.artboard.cord.y=this.artboard.cord.y-this.artboard.layer.height*this.artboard.scale/2,this.artboard.cord.x=r(this.artboard.cord.x),this.artboard.cord.y=r(this.artboard.cord.y),this.paintMask(),this.paintMain(),this.artboard.select&&this.paintAreaSelect(),h.updatePosition())};var k=void 0,E=void 0;n.prototype.onMouseDown=function(t){var e=void 0;return t.preventDefault(),e=this.calculatePosition(t.clientX,t.clientY),this.artboard.layer.validCord(e)?(t.which===b||t.which===y?this.artboard.select?this.artboard.select.insideSelect(e)?(k=e.x-this.artboard.select.cord.x,E=e.y-this.artboard.select.cord.y,w.off("mousemove.canvas").on("mousemove.canvas",this.onDragSelect.bind(this)).on("mouseup.canvas",function(){w.off("mouseup.canvas").off("mousemove.canvas")})):(this.artboard.layer.paintSelect(this.artboard.select),this.artboard.select=void 0,this.paintMain(),this.cleanPrev(),this.tool.onMouseDown(t)):(this.cleanPrev(),this.tool.onMouseDown(t)):t.which===g&&(this.lastDragX=t.clientX,this.lastDragY=t.clientY,this.cleanPrev(),w.off("mousemove.canvas").on("mousemove.canvas",this.onDragMove.bind(this)).off("mouseup.canvas").on("mouseup.canvas",function(){w.off("mouseup.canvas").off("mousemove.canvas")})),!1):void(t.which===y&&this.contextMenu(t))},n.prototype.onDragMove=function(t){t.preventDefault();var e=t.clientX-this.lastDragX,i=t.clientY-this.lastDragY;this.lastDragX=t.clientX,this.lastDragY=t.clientY,this.shiftDiff(new s(e,i))},n.prototype.onDragSelect=function(t){var e=void 0;t.preventDefault(),e=this.calculatePosition(t.clientX,t.clientY),e.x-=k,e.y-=E,this.artboard.select.cord=e,this.paintAreaSelect()},n.prototype.onMouseUp=function(t){t.preventDefault(),this.cleanPrev()},n.prototype.onMouseMove=function(t){var e=void 0;t.preventDefault(),e=this.calculatePosition(t.clientX,t.clientY),this.artboard.layer.validCord(e)?this.drawPreview(t):this.cleanPrev()},n.prototype.shiftDiff=function(t){this.artboard.cord.sum(t),this.paintMask(),this.paintMain(),h.updatePosition()},n.prototype.calculatePosition=function(t,e){return t=o((t-this.artboard.cord.x)/this.artboard.scale),e=o((e-this.artboard.cord.y)/this.artboard.scale),{x:t,y:e}},n.prototype.cordLayerToPaint=function(t){return t.x=t.x*this.artboard.scale+this.artboard.cord.x,t.y=t.y*this.artboard.scale+this.artboard.cord.y,t},n.prototype.center=function(){this.artboard.cord=new s(Math.round(window.innerWidth/2-this.artboard.width/2),Math.round(window.innerHeight/2-this.artboard.height/2)),this.paintMask(),this.paintMain(),h.updatePosition()},n.prototype.addAreaSelect=function(t){this.artboard.select=t},c(n.prototype,i(38)),c(n.prototype,i(39)),c(n.prototype,i(40)),c(n.prototype,i(41)),c(n.prototype,i(42)),t.exports=n},function(t,e,i){"use strict";var n=i(23),s=i(27),a=i(10),o=a.make,r=i(24),h=i(12),l=h.TRANSPARENT_COLOR,c=(n.SNAP,n.FLOAT),d=(n.B,n.L,n.R,n.TL,n.TR,n.BL,n.BR,i(12).events.SELECT_TOOL,new n("Tools",c,new r(500,500),60));d.tools={},d.mainInit=function(){var t=JSON.parse(localStorage.getItem("panel-"+this.name.toLowerCase())||'{"x": 500, "y": 500}'),e=i(33);this.el.style["z-index"]="9";var n=o("div",{parent:this.el,className:"colors"});this.primaryColor=new e(l,!1,35,!0),this.secondaryColor=new e(l,!1,35,!0),this.secondaryColor.appendTo(n).addClass("secondary"),this.primaryColor.appendTo(n).addClass("primary"),this.primaryColor.on("click.primary",function(){s.changeColor(d.getPrimaryColor(),d.setPrimaryColor.bind(d))}),this.secondaryColor.on("click.secondary",function(){s.changeColor(d.getSecondColor(),d.setSecudaryColor.bind(d))}),this.changePosition(new r(t.x,t.y)),this.currentTool=this.tools.pencil;for(var a=0,h=Object.keys(this.tools);a<h.length;a++)this.tools[h[a]].appendTo(this.el)},d.getPrimaryColor=function(){return this.primaryColor.color},d.getSecondColor=function(){return this.secondaryColor.color},d.setPrimaryColor=function(t){return this.primaryColor.changeColor(t),t},d.setSecudaryColor=function(t){return this.secondaryColor.changeColor(t),t},d.changeCurrentTool=function(t){this.lastTool=this.currentTool,this.currentTool=this.tools[t],this.currentTool.active()},d.addTool=function(t){return hasVal(this.tools[t.name])?console.error("Invalid name tool"):void(this.tools[t.name]=t)},t.exports=d},function(t,e,i){"use strict";var n=i(23),s=i(24),a=i(28),o=i(10),r=o.make,h=n.FLOAT,l=i(12).palette.picker,c=l.R,d=l.G,p=l.B,u=l.A,f=i(12).colors.RGBA,v=i(31),g=(i(12).events.CHANGE_SPRITE,new n("ColorPicker",h,new s(500,500),void 0,void 0,void 0,!1,!0));g.mainInit=function(){var t=JSON.parse(localStorage.getItem("panel-"+this.name.toLowerCase())||'{"x": 500, "y": 500}'),e=200,n=50,o=50,h=e+n+o+50,l=i(33);this.el.style.width=h+"px",this.canvasPicker=new a(e,this.onChangeColorCanvasPicker.bind(this)).appendTo(this.el),this.color=new l(void 0,!1,n,!0).appendTo(this.el),this.oldColor=new l(void 0,!1,o,!0).appendTo(this.el),this.changePosition(new s(t.x,t.y)),this.rgbaPicker=new v(f,this.onChangeValueRGBAPicker.bind(this),c,d,p,u),this.rgbaPicker.rangeA.input.min=0,this.rgbaPicker.rangeA.input.max=100,this.rgbaPicker.rangeA.spanValue.textContent=this.rgbaPicker.rangeA.value=this.rgbaPicker.rangeA.input.value=100,this.rgbaPicker.appendTo(this.el),$(r("button",{parent:this.el},"ok")).on("click.ok",this.ok.bind(this)),$(r("button",{parent:this.el},"cancel")).on("click.cancal",this.cancel.bind(this))},g.onChangeColorCanvasPicker=function(t){this.rgbaPicker.setColor(t,!0),this.color.changeColor(t)},g.onChangeValueRGBAPicker=function(t){this.color.changeColor(t),this.canvasPicker.setRGBColor(t)},g.cancel=function(){this.hide()},g.ok=function(){this.callbackChange&&this.callbackChange(this.rgbaPicker.color),this.hide()},g.changeColor=function(t,e){this.rgbaPicker.setColor(t),this.color.changeColor(t),this.oldColor.changeColor(t),this.canvasPicker.setRGBColor(t),this.callbackChange=e,this.show()},t.exports=g},function(t,e,i){"use strict";function n(t,e){var i,n;s.call(this,"canvas-picker"),this.size=t,this.change=!1,this.el.style.width=this.size+25+"px",this.onChange=e,i=u("div",{parent:this.el,className:"content-canvas"}),n=u("div",{parent:this.el,className:"content-rainbow"}),this.canvas=u("canvas",{parent:i,className:"canvas"}).getContext("2d"),this.rainbow=u("canvas",{parent:n,className:"rainbow"}).getContext("2d"),this.canvasPicker=u("div",{parent:i,className:"canvas-picker"}),this.rainbowPicker=u("div",{parent:n,className:"rainbow-picker"}),this.rainbow.canvas.height=this.canvas.canvas.width=this.canvas.canvas.height=this.size,this.rainbow.canvas.width=20,this.canvas.drawImage(o,0,0,255,255,0,0,this.size,this.size),this.rainbow.drawImage(r,0,0,20,255,0,0,20,this.size),$(this.canvas.canvas).on("mousedown.mouse",this.onMouseDownCanvas.bind(this)),$(this.rainbow.canvas).on("mousedown.mouse",this.onMouseDownRainbow.bind(this))}var s=i(9),a=i(12),o=a.GRADIENT,r=a.RAINBOW,h=i(29),l=h.hsvToRgb,c=h.rgbToHsv,d=h.getRGBAComponents,p=i(30),u=i(22);p(n,s),n.prototype.onMouseDownCanvas=function(t){this.isDragCanvas=!0,this.canvas.stats=this.canvas.canvas.getBoundingClientRect(),this.onMouseMoveCanvas(t),$(window).on("mouseup.pickerCanvas",this.onMouseUpCanvas.bind(this)),$(window).on("mousemove.pickerCanvas",this.onMouseMoveCanvas.bind(this))},n.prototype.onMouseUpCanvas=function(t){this.onMouseMoveCanvas(t),$(window).off("mouseup.pickerCanvas"),$(window).off("mousemove.pickerCanvas"),this.isDragCanvas=!1},n.prototype.onMouseMoveCanvas=function(t){var e,i;this.isDragCanvas&&(i=t.clientY-this.canvas.stats.top,e=t.clientX-this.canvas.stats.left,i=0>i?0:i>this.size?this.size:i,e=0>e?0:e>this.size?this.size:e,this.canvasPicker.style.top=i-4+"px",this.canvasPicker.style.left=e-4+"px",this.setColor(this.hue,e/this.size,(this.size-i)/this.size))},n.prototype.onMouseDownRainbow=function(t){this.isDragRainbow=!0,this.rainbow.stats=this.rainbow.canvas.getBoundingClientRect(),this.onMouseMoveRainbow(t),$(window).on("mouseup.pickerCanvas2",this.onMouseUpRainbow.bind(this)),$(window).on("mousemove.pickerCanvas2",this.onMouseMoveRainbow.bind(this))},n.prototype.onMouseUpRainbow=function(t){this.onMouseMoveRainbow(t),$(window).off("mouseup.pickerCanvas2"),$(window).off("mousemove.pickerCanvas2"),this.isDragRainbow=!1},n.prototype.onMouseMoveRainbow=function(t){var e;this.isDragRainbow&&(e=t.clientY-this.rainbow.stats.top,e=0>e?0:e>this.size?this.size:e,this.rainbowPicker.style.top=e-4+"px",this.setColor((this.size-e)/this.size,this.saturation,this.value))},n.prototype.setRGBColor=function(t){var e,i,n;t=d(t),t=c(t[0],t[1],t[2]),e=this.size-t[0]*this.size,i=t[1]*this.size,n=this.size-t[2]*this.size,this.setPositions(e,i,n),this.setColor(t[0],t[1],t[2],!0),this.setBackgroundColor()},n.prototype.setPositions=function(t,e,i){this.rainbowPicker.style.top=t-4+"px",this.canvasPicker.style.left=e-4+"px",this.canvasPicker.style.top=i-4+"px"},n.prototype.setBackgroundColor=function(){var t=l(this.hue,1,1);this.canvas.canvas.style.backgroundColor="rgb("+parseInt(t[0])+", "+parseInt(t[1])+", "+parseInt(t[2])+")"},n.prototype.setColor=function(t,e,i,n){if(t!==this.hue&&(this.hue=t,this.setBackgroundColor()),this.saturation=e,this.value=i,!n&&this.onChange){var s=l(this.hue,this.saturation,this.value);this.onChange("rgb("+parseInt(s[0])+", "+parseInt(s[1])+", "+parseInt(s[2])+")")}},t.exports=n},function(t,e){"use strict";t.exports.rgbToHsl=function(t,e,i){var n,s,a,o,r;if(t/=255,e/=255,i/=255,n=Math.max(t,e,i),min=Math.min(t,e,i),o=(n+min)/2,n==min)s=a=0;else{switch(r=n-min,a=o>.5?r/(2-n-min):r/(n+min),n){case t:s=(e-i)/r+(i>e?6:0);break;case e:s=(i-t)/r+2;break;case i:s=(t-e)/r+4}s/=6}return[s,a,o]},t.exports.hslToRgb=function(t,e,i){var n,s,a,o,r;if(0==e)n=s=a=i;else{var h=function(t,e,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?t+6*(e-t)*i:.5>i?e:2/3>i?t+(e-t)*(2/3-i)*6:t};o=.5>i?i*(1+e):i+e-i*e,r=2*i-o,n=h(r,o,t+1/3),s=h(r,o,t),a=h(r,o,t-1/3)}return[255*n,255*s,255*a]},t.exports.rgbToHsv=function(t,e,i){var n,s,a,o,r,h;if(t/=255,e/=255,i/=255,n=Math.max(t,e,i),s=Math.min(t,e,i),r=n,h=n-s,o=0==n?0:h/n,n==s)a=0;else{switch(n){case t:a=(e-i)/h+(i>e?6:0);break;case e:a=(i-t)/h+2;break;case i:a=(t-e)/h+4}a/=6}return[a,o,r]},t.exports.hsvToRgb=function(t,e,i){var n,s,a,o=Math.floor(6*t),r=6*t-o,h=i*(1-e),l=i*(1-r*e),c=i*(1-(1-r)*e);switch(o%6){case 0:n=i,s=c,a=h;break;case 1:n=l,s=i,a=h;break;case 2:n=h,s=i,a=c;break;case 3:n=h,s=l,a=i;break;case 4:n=c,s=h,a=i;break;case 5:n=i,s=h,a=l}return[255*n,255*s,255*a]},t.exports.getRGBAComponents=function(t){return t.substring(t.indexOf("(")+1,t.lastIndexOf(")")).split(/,\s*/)}},function(t,e){"use strict";t.exports=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t}},function(t,e,i){"use strict";function n(t,e){a.call(this,"picker"),this.name=t+"Picker",this.callbackUpdate=e,this.types=Array.prototype.slice.call(arguments,2);for(var i=0;i<this.types.length;i++){var n=new s(0,0,255,this.types[i],this.onChangeRange.bind(this));n.appendTo(this.el),this["range"+this.types[i]]=n}var o=this.rangeA.spanValue.textContent=this.rangeA.value=this.rangeA.input.value/100;this.color="rgba("+this.rangeR.value+", "+this.rangeG.value+", "+this.rangeB.value+", "+o+")"}var s=i(32),a=i(9),o=i(10),r=o.inheritanceObject,h=i(29),l=h.getRGBAComponents;r(n,a),n.prototype.onChangeRange=function(t){var e=this.rangeA.spanValue.textContent=this.rangeA.value=this.rangeA.input.value/100,i="rgba("+this.rangeR.value+","+this.rangeG.value+","+this.rangeB.value+","+e+")";!t&&this.callbackUpdate&&this.callbackUpdate(i),this.color=i},n.prototype.setColor=function(t,e){var i=l(t);this.rangeR.setValue(i[0]),this.rangeG.setValue(i[1]),this.rangeB.setValue(i[2]),i[3]&&this.rangeA.setValue(100*i[3]),this.onChangeRange(e)},t.exports=n},function(t,e,i){"use strict";function n(t,e,i,n,a){s.call(this),this.value=t,this.max=i,this.min=e,this.type=n,this.input=h(t,this.min,this.max),this.spanName=r(this.type),this.spanValue=r(this.value),this.callback=a,$(this.input).on("input.range"+this.type,this.onChange.bind(this)),this.el.appendChild(this.spanName),this.el.appendChild(this.input),this.el.appendChild(this.spanValue)}var s=i(9),a=i(10),o=a.inheritanceObject,r=a.createSpan,h=a.createInputRange;o(n,s),n.prototype.onChange=function(){this.spanValue.textContent=this.value=this.input.value,this.callback&&this.callback(this.type,this.value)},n.prototype.setValue=function(t){this.input.value=t,this.spanValue.textContent=this.value=this.input.value},t.exports=n},function(t,e,i){"use strict";function n(t,e,i,n){s.call(this,"color"),this.color=t,e&&this.el.classList.add("active"),this.colorEl=r(["div",{parent:this.el}]),this.el.style.backgroundImage="url("+l+")",this.colorEl.style.background=t,this.active=e,this.el.style.height=this.el.style.width=(i||f)+"px",n||$(this.el).on("mousedown.select",this.select.bind(this))}var s=i(9),a=i(10),o=a.inheritanceObject,r=a.make,h=i(12),l=h.TRANSPARENT_IMG_URL,c=h.RIGHT_CLICK,d=h.LEFT_CLICK,p=i(26),u=i(12).palette,f=u.SIZE_COLOR_BLOCK;u.CHANGE_COLOR;o(n,s),n.prototype.select=function(t){console.log("click",t.which),t.which===c?p.setSecudaryColor(this.color):t.which===d&&p.setPrimaryColor(this.color)},n.prototype.changeColor=function(t){this.color=t,this.colorEl.style.background=t},t.exports=n},function(t,e,i){"use strict";var n=i(23),s=i(32),a=i(10),o=a.imageSmoothingDisabled,r=a.make,h=i(12).events,l=(h.CHANGE_SPRITE,h.DELETE_FRAME,n.SNAP),c=(n.FLOAT,n.B,n.L,n.R,n.TL,n.TR),d=(n.BL,n.BR,i(12)),p=d.TRANSPARENT_IMG,u=new n("Preview",l,void 0,15,40,c),f=500,v=void 0,g=0,m=void 0,y=void 0,b=void 0,w=void 0,x=void 0;u.mainInit=function(){this.background=r(["canvas",{className:"background"}]).getContext("2d"),this.preview=r(["canvas",{className:"preview"}]).getContext("2d"),this.areaPreview=r(["div",{className:"area-preview"}]),this.contentPreview=r(["div",{parent:this.el,className:"content-preview"},this.background.canvas,this.preview.canvas,this.areaPreview]),$(this.contentPreview).on("click.stop",this.changeStatus.bind(this)),this.FPSRange=new s(2,0,12,"FPS",this.changeFPS.bind(this)),this.FPSRange.appendTo(this.el)},u.changeFPS=function(t,e){this.stop(),0!=e&&(f=1e3/e,this.start())},u.paintBackground=function(){var t=this.background.createPattern(p,"repeat");this.background.rect(0,0,this.background.canvas.width,this.background.canvas.height),this.background.fillStyle=t,this.background.fill()},u.selectFrame=function(t){g=0},u.selectSprite=function(t){var e=this.contentPreview.getBoundingClientRect();b=Editor.panels.Menus.height,w=Editor.getLeftPanels().width*window.innerWidth/100,x=Editor.getRightPanels().width*window.innerWidth/100,y=window.innerHeight-b,m=window.innerWidth-x-w,t.width>t.height?this.scale=e.width/t.width:this.scale=e.height/t.height,this.background.canvas.width=this.preview.canvas.width=t.width*this.scale,this.background.canvas.height=this.preview.canvas.height=t.height*this.scale,this.background.canvas.style.marginTop=this.preview.canvas.style.marginTop=(e.height-this.preview.canvas.height)/2+"px",this.background.canvas.style.marginLeft=this.preview.canvas.style.marginLeft=(e.width-this.preview.canvas.width)/2+"px",this.start(),this.paintBackground()},u.start=function(){this.started||(this.started=!0,v=setInterval(function(){u.loop()},f))},u.changeStatus=function(){this.started?this.stop():this.start()},u.stop=function(){this.started=!1,clearInterval(v)},u.loop=function(){g>=Editor.sprite.frames.length-1&&(g=-1),g++,this.clean(),o(this.preview),this.preview.drawImage(Editor.sprite.frames[g].context.canvas,0,0,this.preview.canvas.width,this.preview.canvas.height)},u.resize=function(){},u.updatePosition=function(){var t=Editor.canvas.artboard,e=void 0,i=this.scale,n=b/t.scale*i,s=w/t.scale*i,a=t.scale*t.layer.height,o=t.cord.y/t.scale*i,r=t.cord.x/t.scale*i,h=t.scale*t.layer.width;a>y?(e=(a-(a-y))/t.scale,this.areaPreview.style.height=e*i+"px"):this.areaPreview.style.height="100%",h>m?(e=(h-(h-m))/t.scale,this.areaPreview.style.width=e*i+"px"):this.areaPreview.style.width="100%",0>r-s?this.areaPreview.style.left=Math.abs(r-s)+"px":this.areaPreview.style.left="0",0>o-n?this.areaPreview.style.top=Math.abs(o-n)+"px":this.areaPreview.style.top="0"},u.clean=function(){this.preview.clearRect(0,0,this.preview.canvas.width,this.preview.canvas.height)},t.exports=u},function(t,e){"use strict";function i(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}t.exports=i},function(t,e){"use strict";t.exports=function(t,e){t.imageSmoothingEnabled=e,t.mozImageSmoothingEnabled=e,t.msImageSmoothingEnabled=e}},function(t,e,i){"use strict";function n(t,e,i){var n=arguments.length<=3||void 0===arguments[3]?!1:arguments[3];this.$type=n?"ul":"li",s.call(this,"menu","menu-"+t.replace(/ /g,"-"),n?"context-menu":"menu"),this.name=t,this.type=e,this["float"]=n,n||(this.el.textContent=this.name),e==l?(this.structure=i.structure,n?(this.addClass("list-menus"),this.ul=this.el):this.ul=a(["ul",{parent:this.el,className:"list-menus"}]),this.init()):(this.fn=i.fn,this.on("click.active",this.fn))}var s=i(9),a=i(22),o=i(10),r=(o.createDiv,o.createSpan,o.defineGetter,o.inheritanceObject),h="MENU",l="MENUS";r(n,s),n.MENU=h,n.MENUS=l,n.prototype.init=function(){this.ul.innerHTML="";for(var t=0;t<this.structure.length;t++){var e=this.structure[t];e.appendTo(this.ul)}},n.prototype.setStructure=function(t){this.structure=t,this.init()},n.createMenu=function(t,e){return new n(t,h,{fn:e})},n.createMenus=function(t,e){return new n(t,l,{structure:e})},n.createContext=function(){var t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];return new n("context",l,{structure:t},!0)},t.exports=n},function(t,e){"use strict"},function(t,e){"use strict";t.exports.cleanAt=function(t){t=this.cordLayerToPaint(t),this.main.clearRect(t.x,t.y,this.sizePointer,this.sizePointer)},t.exports.cleanMain=function(){this.main.clearRect(0,0,this.main.canvas.width,this.main.canvas.height)},t.exports.paintAt=function(t,e){t=this.cordLayerToPaint(t),this.main.fillStyle=e,this.main.clearRect(t.x,t.y,this.sizePointer,this.sizePointer),this.main.fillRect(t.x,t.y,this.sizePointer,this.sizePointer)},t.exports.paintMain=function(){var t,e;this.cleanMain(),e=this.artboard.layer.width*this.artboard.scale,t=this.artboard.layer.height*this.artboard.scale,this.paintBackground(),this.main.drawImage(this.artboard.layer.context.canvas,0,0,this.artboard.layer.width,this.artboard.layer.height,this.artboard.cord.x,this.artboard.cord.y,e,t)}},function(t,e,i){"use strict";var n=i(24),s=i(26),a=i(12),o=a.COLOR_POINTER_PREW_DEF,r=a.TRANSPARENT_IMG;t.exports.cleanPrev=function(){this.preview.clearRect(0,0,this.preview.canvas.width,this.preview.canvas.height)},t.exports.previewAt=function(t,e){t=this.cordLayerToPaint(t),this.preview.fillStyle=e,this.preview.clearRect(t.x,t.y,this.sizePointer,this.sizePointer),this.preview.fillRect(t.x,t.y,this.sizePointer,this.sizePointer)},t.exports.drawPreview=function(t){this.cleanPrev(),this.artboard.select&&this.paintAreaSelect();var e=new n(Math.floor((t.clientX-this.artboard.cord.x)/this.artboard.scale),Math.floor((t.clientY-this.artboard.cord.y)/this.artboard.scale)),i=new n(e.x*this.artboard.scale+this.artboard.cord.x,e.y*this.artboard.scale+this.artboard.cord.y);this.preview.strokeStyle=o,this.preview.fillStyle=s.getPrimaryColor(),this.preview.strokeRect(i.x-1,i.y-1,this.sizePointer+2,this.sizePointer+2),this.preview.fillRect(i.x,i.y,this.sizePointer,this.sizePointer)},t.exports.paintAreaSelect=function(){var t=this.preview.createPattern(r,"repeat");this.preview.rect(this.artboard.select.originalCord.x*this.artboard.scale+this.artboard.cord.x,this.artboard.select.originalCord.y*this.artboard.scale+this.artboard.cord.y,this.artboard.select.width*this.artboard.scale,this.artboard.select.height*this.artboard.scale),this.preview.fillStyle=t,this.preview.fill(),this.preview.drawImage(this.artboard.select.context.canvas,0,0,this.artboard.select.width,this.artboard.select.height,this.artboard.cord.x+this.artboard.select.cord.x*this.artboard.scale,this.artboard.cord.y+this.artboard.select.cord.y*this.artboard.scale,this.artboard.select.width*this.artboard.scale,this.artboard.select.height*this.artboard.scale),this.prevSelect(this.artboard.select.cord.x,this.artboard.select.cord.y,this.artboard.select.width,this.artboard.select.height)},t.exports.prevSelect=function(t,e,i,n){var s=this.cordLayerToPaint({x:t,y:e});this.preview.save(),this.preview.beginPath(),this.preview.setLineDash([5]),this.preview.strokeStyle="black",this.preview.fillStyle="transparent",this.preview.strokeRect(s.x,s.y,i*this.artboard.scale,n*this.artboard.scale),this.preview.stroke(),this.preview.beginPath(),this.preview.strokeStyle="white",this.preview.lineDashOffset=5,this.preview.strokeRect(s.x,s.y,i*this.artboard.scale,n*this.artboard.scale),this.preview.stroke(),this.preview.restore()}},function(t,e){"use strict";t.exports.paintMask=function(){var t=this.artboard.layer.width*this.artboard.scale,e=this.artboard.layer.height*this.artboard.scale;this.mask.fillStyle="gray",this.mask.fillRect(0,0,this.mask.canvas.width,this.mask.canvas.width),this.mask.clearRect(this.artboard.cord.x,this.artboard.cord.y,t,e)}},function(t,e,i){"use strict";var n=i(12),s=n.TRANSPARENT_IMG;t.exports.paintBackground=function(){var t=this.background.createPattern(s,"repeat");this.cleanBackground(),this.background.rect(this.artboard.cord.x,this.artboard.cord.y,this.artboard.layer.width*this.artboard.scale,this.artboard.layer.height*this.artboard.scale),this.background.fillStyle=t,this.background.fill()},t.exports.cleanBackground=function(){this.background.canvas.width=this.background.canvas.width}},function(t,e,i){"use strict";function n(t,e){this.width=t,this.height=e,this.frames=[],this.frames.push(new s(this,0,!0)),d.selectSprite(this)}var s=i(44),a=(i(58),i(61)),o=i(54),r=i(56),h=i(55),l=i(64)(),c=i(10),d=(c.downloadBlob,i(34));n.prototype.getFrame=function(t){return this.frames[t]},n.prototype.deleteFrame=function(t,e){if(1==this.frames.length)return alert("can't delete last frames"),!1;var i=this.frames.splice(t,1)[0];return this.reIndexing(),e||h.addUndo(new o(o.DELETE_FRAME,{frame:i},0)),i&&i.index==Editor.canvas.artboard.layer.frame.index&&(this.frames.length<=t&&t--,this.frames[t].select()),!0},n.prototype.getTransparentColor=function(t){function e(e){t&&(n.transparentColor=e.data,t(e.data))}for(var i=[],n=this,s=0;s<this.frames.length;s++)i.push(this.frames[s].imageData.data);l.postMessage({type:"transparent",data:i}),l.onmessage=e.bind(this)},n.prototype.getAllDataImage=function(){for(var t=[],e=0;e<this.frames.length;e++)t=t.concat(this.frames[e].getDataList());return t},n.prototype.getGeneralColors=function(t){function e(e){t(e.data)}var i=this.getAllDataImage();l.postMessage({type:"general",data:i}),l.onmessage=e.bind(this)},n.prototype.generateGif=function(t){function e(e){for(var n=e,s=0;s<this.frames.length;s++)i.addFrame(this.frames[s].generatePreview(t,n),{transparent:parseInt(n.substring(1),16)});i.render()}var i=new a({quality:1,repeat:0,height:this.height*t,width:this.width*t,preserveColors:!0});i.on("finished",function(t){window.open(URL.createObjectURL(t))}),Editor.timeoutGetTransparentColor?Editor.addCallbackGetColor(e.bind(this)):e.call(this,this.transparentColor)},n.prototype.reIndexing=function(){for(var t=0;t<this.frames.length;t++)this.frames[t].index=t},n.prototype.resize=function(t,e,i,n,s){this.width=t,this.height=e;for(var a=0;a<this.frames.length;a++)this.frames[a].resize(i,n,s);d.selectSprite(this)},n.prototype.moveFrame=function(t,e){var i=this.frames.splice(t,1),n=void 0;d.stop(),n=this.frames.splice(e),this.frames=this.frames.concat(i,n),this.reIndexing(),d.selectFrame(),d.start()},n.prototype.paint=function(){},n.prototype.selectFrame=function(t){if(Number.isInteger(t))t=this.frames[t];else if(!(t instanceof s))throw new Error;t.select()},n.prototype.addFrame=function(t,e,i){var n=!1,a=void 0;i?(a=t,r.addPreview(a)):(t instanceof s?n=!0:Number.isInteger(t)&&(n=!0,t=this.frames[t]),Number.isInteger(e)||(e=n?t.index+1:this.frames.length),a=n?t.clone():new s(this,e,!0),n&&(a.index=e,a.layers=t.cloneLayers(a)));var l=this.frames.splice(e);return 0!==l.length?(this.frames=this.frames.concat([a],l),this.reIndexing()):this.frames.push(a),n&&a.init(),a.select(),a.paint(),i||h.addUndo(new o(o.ADD_FRAME,{frame:a},0)),a},n.prototype.putImagesData=function(t){for(var e=0;e<t.length;e++)for(var i=t[e],n=0;n<i.length;n++)this.frames[e].layers[n].context.putImageData(i[n],0,0)},t.exports=n},function(t,e,i){"use strict";function n(t,e,i,n,s){this.sprite=t,this.index=e,this.status=i,this.layers=n||[new r(this,0)],this.context=document.createElement("canvas").getContext("2d"),s||this.init()}var s=i(10),a=s.imageSmoothingDisabled,o=(i(45),i(12)),r=(o.TRANSPARENT_COLOR,i(46)),h=i(54),l=i(55),c=i(56),d=i(47);i(12).events.UPDATE_FRAME;n.prototype={constructor:n,get canvas(){return Editor.canvas},get imageData(){return this.context.getImageData(0,0,this.sprite.width,this.sprite.height)},get width(){return this.sprite.width},get height(){return this.sprite.height}},n.prototype.init=function(){a(this.context),this.context.canvas.width=this.sprite.width,this.context.canvas.height=this.sprite.height,c.addPreview(this),this.paint(!0)},n.prototype.resize=function(t,e,i){this.context.canvas.width=this.width,this.context.canvas.height=this.height;for(var n=0;n<this.layers.length;n++)this.layers[n].resize(t,e,i);c.resizeFrame(this.index),this.paint()},n.prototype.deleteLayer=function(t,e){if(1==this.layers.length)return alert("can't delete last frames"),!1;var i=this.layers.splice(t,1)[0];return this.reIndexing(),e||l.addUndo(new h(h.DELETE_LAYER,{layer:i},0)),i&&i.index==Editor.canvas.artboard.layer.index&&(this.layers.length<=t&&t--,this.layers[t].select()),this.paint(),!0},n.prototype["delete"]=function(t){this.sprite.deleteFrame(this.index,t)&&c.deletePreview(this.index)},n.prototype.reIndexing=function(){for(var t=0;t<this.layers.length;t++)this.layers[t].index=t},n.prototype.cloneLayers=function(t){var e=[];t=t||this;for(var i=0;i<this.layers.length;i++){var n=this.layers[i].clone(t);e.push(n)}return e},n.prototype.selectLayer=function(t){if(Number.isInteger(t))t=this.frames[t];else if(!(t instanceof r))throw new Error;
t.select()},n.prototype.select=function(){c.selectFrame(this.index),d.changeFrame(this),this.layers[0].select()},n.prototype.clone=function(t){return t=t||this.sprite,new n(t,this.index+1,this.status,this.cloneLayers(),!0)},n.prototype.addLayer=function(t,e,i){var n=!1,s=void 0;i?(s=t,d.addPreview(s)):(t instanceof r?n=!0:Number.isInteger(t)&&(n=!0,t=this.layers[t]),Number.isInteger(e)||(e=n?t.index+1:this.layers.length),s=n?t.clone():new r(this,e,!0),n&&(s.index=e));var a=this.layers.splice(e);return 0!==a.length?(this.layers=this.layers.concat([s],a),this.reIndexing()):this.layers.push(s),n&&s.init(),s.select(),d.updateLayers(s.index),this.paint(),i||l.addUndo(new h(h.ADD_LAYER,{layer:s},0)),s},n.prototype.getDataList=function(){return this.layers.map(function(t){return t.imageData.data})},n.prototype.getIMG=function(){var t=document.createElement("img");return t.src=this.context.canvas.toDataURL(),t},n.prototype.clean=function(){this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height)},n.prototype.paint=function(t){this.clean();for(var e=this.layers.length-1;e>-1;e--){var i=this.layers[e];this.context.drawImage(i.context.canvas,0,0,this.width,this.height,0,0,this.width,this.height)}c.paintFrame(this.index),this.sprite.paint()},n.prototype.moveFrame=function(t,e){var i=this.layers.splice(t,1),n=void 0;n=this.layers.splice(e),this.layers=this.layers.concat(i,n),this.reIndexing(),this.paint()},n.prototype.generatePreview=function(t,e){var i=this.height*t,n=this.width*t,s=void 0;this.context.canvas.width=n,this.context.canvas.height=i,s=this.imageData.data,a(this.context),this.context.drawImage(this.context.canvas,0,0,this.width,this.height,0,0,n,i),this.context.fillStyle=e;for(var o=0;o<s.length;o+=4)if(!(s[o]||s[o+1]||s[o+2]||s[o+3])){var r=o/4,h=r%20,l=~~(r/20);this.context.fillRect(h*t,l*t,t,t)}return this.context},t.exports=n},function(t,e){"use strict";t.exports=function(t,e){for(var i=0;i<t.length;i++)for(var n=0;n<t[i].length;n++)e(t[i][n],i,n)}},function(t,e,i){"use strict";function n(t,e,i,n,s){if(this.frame=t,this.index=e,this.status=i,this.context=n||document.createElement("canvas").getContext("2d"),this.bitmap=s||new Array(this.frame.width),!s)for(var a=0;a<this.bitmap.length;a++)this.bitmap[a]=new Array(this.frame.height).fill(d);n||this.init()}var s=i(10),a=s.imageSmoothing,o=i(47),r=i(53),h=i(54),l=i(55),c=i(12),d=c.TRANSPARENT_COLOR;n.prototype={constructor:n,get canvas(){return Editor.canvas},get imageData(){return this.context.getImageData(0,0,this.sprite.width,this.sprite.height)},get width(){return this.frame.width},get height(){return this.frame.height},get sprite(){return this.frame.sprite}},n.prototype.init=function(){var t=this.context.getImageData(0,0,this.context.canvas.width,this.context.canvas.height);a(this.context,!1),this.context.canvas.width=this.width,this.context.canvas.height=this.height,this.context.putImageData(t,0,0),Editor.canvas&&Editor.canvas.artboard.layer.frame==this.frame&&o.addPreview(this)},n.prototype.cloneBitmap=function(){for(var t=[],e=0;e<this.bitmap.length;e++)t.push(this.bitmap[e].slice(0));return t},n.prototype.resize=function(t,e,i){var n=document.createElement("canvas").getContext("2d"),s=void 0,r=void 0,h=void 0,l=void 0,c=void 0,d=void 0,p=void 0,u=void 0;s=0,r=0,c=this.context.canvas.width,p=this.context.canvas.height,h=e,l=i,t?(d=this.width,u=this.height):(d=this.context.canvas.width,u=this.context.canvas.height),n.canvas.width=this.width,n.canvas.height=this.height,a(n,!1),console.log(s,r,c,p,h,l,d,u),n.drawImage(this.context.canvas,s,r,c,p,h,l,d,u),this.context=n,o.resizeLayer(this.index),Editor.canvas.resize()},n.prototype.saveImageData=function(){this.prevImageDataState=this.imageData},n.prototype.saveStatus=function(){this.prevStatus=document.createElement("canvas"),this.prevStatus.width=this.width,this.prevStatus.height=this.height,this.prevStatus.getContext("2d").drawImage(this.context.canvas,0,0)},n.prototype["delete"]=function(t){this.frame.deleteLayer(this.index,t)&&o.deletePreview(this.index)},n.prototype.getIMG=function(){var t=document.createElement("img");return t.src=this.context.canvas.toDataURL(),t},n.prototype.clone=function(t){return t=t||this.frame,new n(t,this.index,this.status,this.cloneContext(),this.cloneBitmap())},n.prototype.select=function(){Editor.canvas.changeLayer(this),o.createPreviewLayer(),o.selectLayer(this.index)},n.prototype.cloneContext=function(){var t=this.context.canvas.cloneNode().getContext("2d");return t.drawImage(this.context.canvas,0,0),t},n.prototype.validCord=function(t){return t.x>=0&&t.x<this.width&&t.y>=0&&t.y<this.height},n.prototype.isSameColor=function(t,e,i,n){var s=4*(t+e*this.width);return t>=0&&t<this.width&&e>=0&&e<this.height&&this.prevImageDataState.data[s]==i[0]&&this.prevImageDataState.data[s+1]==i[1]&&this.prevImageDataState.data[s+2]==i[2]&&this.prevImageDataState.data[s+3]/255==i[3]?(this.prevImageDataState.data[s]=n[0],this.prevImageDataState.data[s+1]=n[1],this.prevImageDataState.data[s+2]=n[2],this.prevImageDataState.data[s+3]=255*n[3],!0):!1},n.prototype.getColorPixel=function(t){var e=4*(t.x+t.y*this.width);return e>=0&&e<=this.prevImageDataState.data.length?"rgba("+this.prevImageDataState.data[e]+", "+this.prevImageDataState.data[e+1]+", "+this.prevImageDataState.data[e+2]+", "+this.prevImageDataState.data[e+3]/255+")":void 0},n.prototype.cleanAt=function(t){this.context.clearRect(t.x,t.y,1,1),this.canvas.cleanAt(t,d)},n.prototype.fillCleanAt=function(t){this.context.clearRect(t.x,t.y,1,1)},n.prototype.fillAt=function(t,e){this.context.fillStyle=e,this.context.clearRect(t.x,t.y,1,1),this.context.fillRect(t.x,t.y,1,1)},n.prototype.paintPrevAt=function(t,e){this.canvas.previewAt(t,e)},n.prototype.paintAt=function(t,e){this.context.fillStyle=e,this.context.clearRect(t.x,t.y,1,1),this.context.fillRect(t.x,t.y,1,1),this.canvas.paintAt(t,e)},n.prototype.paintStroke=function(t){for(var e=new Array(t.length),i=void 0,n=0;n<e.length;n++)e[n]=[];for(var s=0;s<t.length;s++)for(var a=0;a<t[s].length;a++)(i=t[s][a])&&(i==d?e[s][a]=this.cleanAt({x:s,y:a}):e[s][a]=this.paintAt({x:s,y:a},i));return o.paintLayer(this.index),this.frame.paint(),{layer:this,stroke:e}},n.prototype.paintEverywhere=function(){o.updateLayers(this.index),this.frame.paint(),Editor.canvas.paintMain()},n.prototype.restoreState=function(t){return this.saveStatus(),this.context.canvas.width=t.height,this.context.drawImage(t,0,0,t.width,t.height,0,0,t.width,t.height),this.paintEverywhere(),{layer:this,data:this.prevStatus}},n.prototype.paint=function(){o.updateLayers(this.index),this.frame.paint()},n.prototype.generatePreview=function(t){return this.context},n.prototype.prevSelect=function(t,e,i,n){Editor.canvas.prevSelect(t,e,i,n)},n.prototype.getSelect=function(t,e,i,n){var s=void 0;s=new r({x:t,y:e},i,n,this),this.paintEverywhere(),Editor.canvas.addAreaSelect(s)},n.prototype.paintSelect=function(t){this.context.clearRect(t.originalCord.x,t.originalCord.y,t.originalWidth,t.originalHeight),this.context.drawImage(t.context.canvas,t.cord.x,t.cord.y,t.width,t.height),l.addUndo(new h(h.PAINT,{layer:this,data:this.prevStatus},0))},t.exports=n},function(t,e,i){"use strict";var n=i(23),s=i(48),a=n.SNAP,o=(n.FLOAT,n.B,n.L),r=(n.R,n.TL,n.TR,n.BL,n.BR,i(22)),h=i(24),l=i(49),c=r("button",{className:"add-layer"},"add layer"),d=new n("Layers",a,new h(0,0),100,100,o,!0),p=0;d.mainInit=function(){this.list=new l("layers",[],15),r([this.el,c,this.list.el]),$(c).on("click.add",this.createLayer.bind(this))},d.$add=function(){Editor.addPanel(this,i(50))},d.createLayer=function(){this.frame.addLayer()},d.createPreviewLayer=function(){},d.deletePreview=function(t){this.list.remove(t)},d.addPreview=function(t){this.list.add(new s(t,t.index==p,this.list),t.index)},d.selectLayer=function(t){},d.changeFrame=function(t){this.list.removeAll();for(var e=0;e<t.layers.length;e++)this.addPreview(t.layers[e])},d.updateLayers=function(t){this.list.elements[t].paint()},d.resizeLayer=function(t){this.list.elements[t].resize()},d.paintLayer=function(){},t.exports=d},function(t,e,i){"use strict";function n(t,e,i){this.$type="li",s.call(this,"preview-layer"),this.layer=t,this.selected=e,this.list=i,this.background=r("canvas",{parent:this.el}).getContext("2d"),this.context=r("canvas",{parent:this.el}).getContext("2d"),this.spanIndex=r("span",{parent:this.el,className:"index"},this.layer.index+1),this.btnClone=r("button",{parent:this.el,className:"btn btn-clone"},"C"),this.btnHidden=r("button",{parent:this.el,className:"btn btn-hidden"},"H"),this.btnDelete=r("button",{parent:this.el,className:"btn btn-delete"},"D"),e&&this.el.classList.add("active"),$(this.btnDelete).on("click.delete",this.onDelete.bind(this)),$(this.btnClone).on("click.clone",this.onClone.bind(this)),$(this.el).on("click.layer",this.onClick.bind(this))}var s=i(9),a=i(12),o=a.TRANSPARENT_IMG,r=i(22),h=i(10),l=h.inheritanceObject,c=h.imageSmoothingDisabled,d=h.defineGetter;l(n,s),d(n.prototype,"index",function(){return this.layer.index}),n.prototype.onClone=function(t){t.stopPropagation(),this.layer.frame.addLayer(this.layer)},n.prototype.onDelete=function(t){t.stopPropagation(),this.layer["delete"]()},n.prototype.selectLayer=function(){},n.prototype.unSelectLayer=function(){},n.prototype.setIndex=function(t){this.layer.frame.moveFrame(this.index,t)},n.prototype.resize=function(){var t=this.el.clientWidth;this.el.style.height=t+"px",this.el.style.width=t+"px",this.layer.width>this.layer.height?(this.background.canvas.width=this.context.canvas.width=t,this.scale=t/this.layer.width,this.background.canvas.height=this.context.canvas.height=this.layer.height*this.scale,this.background.canvas.style.marginTop=this.context.canvas.style.marginTop=(t-this.background.canvas.height)/2+"px"):(this.background.canvas.height=this.context.canvas.height=t,this.scale=t/this.layer.height,this.background.canvas.width=this.context.canvas.width=this.layer.width*this.scale,this.background.canvas.style.marginLeft=this.context.canvas.style.marginLeft=(t-this.background.canvas.width)/2+"px"),this.paintBackground(),this.paint()},n.prototype.appendTo=function(t){return t.appendChild(this.el),this.resize(),this.el.classList.remove("active"),this.spanIndex.textContent=this.layer.index+1,this},n.prototype.paintBackground=function(){var t=this.background.createPattern(o,"repeat");this.background.rect(0,0,this.background.canvas.width,this.background.canvas.height),this.background.fillStyle=t,this.background.fill()},n.prototype.changeLayer=function(t){this.layer=t},n.prototype.updateIndex=function(){this.spanIndex.textContent=this.layer.index+1},n.prototype.update=function(){},n.prototype.onClick=function(){this.layer.frame.selectLayer(this.layer)},n.prototype.paint=function(){this.clean(),c(this.context),this.context.drawImage(this.layer.context.canvas,0,0,this.layer.width*this.scale,this.layer.height*this.scale)},n.prototype.clean=function(){this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height)},t.exports=n},function(t,e,i){"use strict";function n(t,e,i){this.$type="ul",r.call(this,"list",t.toLowerCase()+"-list"),this.name=t,e&&!Array.isArray(e)&&(e=[e]),this.margin=i,this.elements=e||[]}function s(t){"CANVAS"===t.target.tagName&&(this.el.classList.add("drag"),$(window).off("mouseup.drag").on("mouseup.drag",a.bind(this)),$(window).off("mousemove.drag").on("mousemove.drag",o.bind(this)))}function a(t){var e=this.list.el.getBoundingClientRect(),i=this.list.realHeight*(this.list.elements.length-1),n=t.clientY-e.top+this.list.el.scrollTop-this.list.realHeight/2,s=Math.floor((n+this.list.realHeight/2)/this.list.realHeight),a=this.index,o=void 0,r=void 0;n>i?n=i:0>n&&(n=0),0>s?s=0:s>this.list.elements-1&&(s=this.list.elements-1),$(window).off("mousemove.drag"),$(window).off("mouseup.drag"),s!==a&&(this.setIndex(s),o=this.list.elements.splice(a,1),r=this.list.elements.splice(s),this.list.elements=this.list.elements.concat(o,r)),this.list.order(),this.el.classList.remove("drag")}function o(t){var e=this.list.el.getBoundingClientRect(),i=this.list.realHeight*(this.list.elements.length-1),n=t.clientY-e.top+this.list.el.scrollTop-this.list.realHeight/2,s=Math.floor((n+this.list.realHeight/2)/this.list.realHeight);n>i?n=i:0>n&&(n=0),0>s?s=0:s>this.list.elements-1&&(s=this.list.elements-1),this.list.orderDrag(this,s),this.el.style.top=n+"px"}var r=i(9),h=(i(24),Math.abs,i(10)),l=h.inheritanceObject;h.defineGetter;l(n,r),n.prototype.init=function(){for(var t=0;t<this.elements.length;t++)this.elements[t].appendTo(this.el)},n.prototype.remove=function(t){this.elements[t]&&(this.elements[t].remove(),this.elements.splice(t,1),this.order())},n.prototype.add=function(t,e){if(t.appendTo(this.el),t.on("mousedown.drag",s.bind(t)),this.elements[e]){var i=this.elements.splice(e);this.elements=this.elements.concat([t],i)}else this.height||(this.height=t.el.clientHeight,this.realHeight=this.height+this.margin),this.elements.push(t);t.el.style.position="absolute",this.order()},n.prototype.order=function(){for(var t=0;t<this.elements.length;t++)this.elements[t].el.style.top=t*this.realHeight+"px",this.elements[t].updateIndex()},n.prototype.removeAll=function(){for(var t=0;t<this.elements.length;t++)this.elements[t].remove();this.elements.length},n.prototype.orderDrag=function(t,e){for(var i=0,n=0;n<this.elements.length;n++)0==n&&0===e&&(i+=this.realHeight),this.elements[n]!=t&&(t.index>n&&0!==e&&e===n&&(i+=this.realHeight),this.elements[n].el.style.top=i+"px",i+=this.realHeight,t.index<n&&0!==e&&e===n&&(i+=this.realHeight))},t.exports=n},function(t,e,i){"use strict";var n=i(51),s=i(23),a=i(24),o=i(52),r=i(22),h=new n("Left",s.SNAP,new a(0,0),13,100,s.TL,!0,!1,n.TABS);h.mainInit=function(){var t=this.el.getBoundingClientRect(),e=this.panels.length;console.log(o.height),this.el.style.borderWidth=0;for(var i=0;e>i;i++)this.tabs[i]={el:r("div",{parent:this.el,className:"content-panel-tab"},this.panels[i].name),panel:this.panels[i],parent:this},this.tabs[i].el.style.lineHeight=this.panels[i].el.style.top=this.tabs[i].el.style.height=o.height+"px",this.panels[i].el.style.width="100%",this.panels[i].el.style.height="calc(100% - "+this.panels[i].el.style.top+")",this.panels[i].hide(),this.tabs[i].el.style.width=t.width/e+"px",$(this.tabs[i].el).on("click.tabs",this.onClick.bind(this.tabs[i]));this.panels[1].show(),this.tabs[1].el.classList.add("active")},h.onClick=function(t){for(var e=0;e<this.parent.panels.length;e++)this.parent.panels[e].hide(),this.parent.tabs[e].el.classList.remove("active");this.el.classList.add("active"),this.panel.show()},t.exports=h},function(t,e,i){"use strict";function n(t,e,i,a,o,r,h,l,c){s.call(this,t,e,i,a,o,r,h,l),this.panels=[],this.typeContent=c,n.TABS==c&&(this.tabs=[])}var s=i(23),a=i(30);i(22);a(n,s),n.NORMAL="normal",n.TABS="tabs",n.prototype.addPanel=function(t){return t.appendTo(this.el),this.panels.push(t),t},t.exports=n},function(t,e,i){"use strict";var n=i(23),s=i(10),a=s.make,o=(i(24),i(37)),r=i(12),h=(r.TRANSPARENT_COLOR,n.SNAP),l=(n.FLOAT,n.T),c=(n.B,i(12).events.SELECT_TOOL,new n("Menus",h,void 0,100,25,l,!0));c.mainInit=function(){this.logo=a(["image",{parent:this.el,className:"logo"}]),this.inputName=a("input",{parent:this.el,value:"New Project*",className:"name-project"}),this.listMenus=a(["ul",{parent:this.el,className:"list-menus"}]),this.test=o.createMenus("test",[o.createMenu("test2",function(){return alert("hi test2")}),o.createMenus("test3",[o.createMenu("test3.2",function(){return alert("hi test3.2")})])]),console.info(this.test),this.projectMenu=o.createMenus("project",[o.createMenu("new project",function(){return alert("not yet")}),o.createMenu("save project",function(){return alert("save project")}),o.createMenu("new sprite",function(){return alert("new sprite")})]).appendTo(this.listMenus),this.spriteMenu=o.createMenus("sprite",[o.createMenu("resize",function(){return Editor.panels.Resize.show()}),o.createMenu("set background",function(){return alert("set background")})]).appendTo(this.listMenus),this.layerMenu=o.createMenus("layer",[o.createMenu("set background",function(){return Editor.panels.BackgroundLayer.show()})]).appendTo(this.listMenus),this.spriteMenu=o.createMenus("help",[o.createMenu("documentation",function(){return alert("not yet")}),o.createMenu("about",function(){return alert("soon")})]).appendTo(this.listMenus)},c.onGenerateGif=function(){Editor.sprite.generateGif(parseInt(this.inputScale.value))},t.exports=c},function(t,e,i){"use strict";function n(t,e,i,n){0>e&&(t.x+=e,e=Math.abs(e)),0>i&&(t.y+=i,i=Math.abs(i)),this.originalCord=this.cord=t,this.originalWidth=this.width=e,this.originalHeight=this.height=i,this.source=n,this.context=document.createElement("canvas").getContext("2d"),s(this.context,!1),this.context.canvas.width=Math.abs(e),this.context.canvas.height=Math.abs(i),this.context.drawImage(n.context.canvas,t.x,t.y,e,i,0,0,e,i)}var s=i(36);n.prototype.insideSelect=function(t){return t.x>=this.cord.x&&t.x<=this.cord.x+this.width&&t.y>=this.cord.y&&t.y<=this.cord.y+this.height},t.exports=n},function(t,e,i){"use strict";function n(t,e,i,n){this.$type="li",s.call(this,"action"),this.type=t,this.data=e,this.index=i,this.redo=n,$(this.el).on("click.undo",this.onClick.bind(this))}var s=i(9),a=i(55),o=i(10),r=o.inheritanceObject,h=(o.defineGetter,{paint:function(t){return t.layer.restoreState(t.data)},resize:function(t){var e={width:t.sprite.width,height:t.sprite.height,sprite:t.sprite,data:t.sprite.frames.map(function(t){return t.layers.map(function(t){return t.imageData})})};return t.sprite.resize(t.width,t.height),t.sprite.putImagesData(t.data),Editor.canvas.artboard.layer.frame.sprite==t.sprite&&Editor.canvas.center(),e},delete_layer:function(t){return t.layer.frame.addLayer(t.layer,t.layer.index,!0),t},add_layer:function(t){return t.layer["delete"](!0),t},delete_frame:function(t){return t.frame.sprite.addFrame(t.frame,t.frame.index,!0),t},add_frame:function(t){return t.frame["delete"](!0),t}}),l={_redo:function(t){a.removeRedo(t.index),t.redo=!1,a.addUndo(t.setIndex(0),!0)},_undo:function(t){a.removeUndo(t.index),t.redo=!0,a.addRedo(t.setIndex(0))},_:function(t){t.redo?this._redo(t):this._undo(t)},paint:function(t){this._(t)},resize:function(t){this._(t)},delete_layer:function(t){t.type="add_layer",this._(t)},add_layer:function(t){t.type="delete_layer",this._(t)},delete_frame:function(t){t.type="add_frame",this._(t)},add_frame:function(t){t.type="delete_frame",this._(t)}};r(n,s),n.prototype.onClick=function(t){a.undo(this.index)},n.PAINT="paint",n.RESIZE="resize",n.DELETE_LAYER="delete_layer",n.DELETE_FRAME="delete_frame",n.ADD_LAYER="add_layer",n.ADD_FRAME="add_frame",n.prototype.changeEl=function(t){this.el=t,this.el.textContent=this.type},n.prototype.execute=function(){console.log(this.type),this.data=h[this.type](this.data),l[this.type](this)},n.prototype.setIndex=function(t){return this.index=t,this},n.prototype.init=function(t){return this.el.textContent=this.type,this.appendTo(t),this},n.prototype.newEl=function(){s.call(this,"action"),$(this.el).on("click.undo",this.onClick.bind(this))},t.exports=n},function(t,e,i){"use strict";var n=i(23),s=i(24),a=i(10),o=a.make,r=n.SNAP,h=(n.B,n.L,n.R),l=(n.TL,n.TR,n.BL,n.BR,i(12).events.CHANGE_SPRITE,new n("Actions",r,new s(100,40),15,20,h));l.mainInit=function(){var t=o("div",{className:"content-lists"});$(o("button",{parent:o("div",{parent:this.el,className:"content-undo"})},"undo")).on("click.undo",this.undo.bind(this)),$(o("button",{parent:o("div",{parent:this.el,className:"content-redo"})},"redo")).on("click.redo",this.redo.bind(this)),this.elRedo=o("ul",{parent:t,className:"list-redo"}),this.elUndo=o("ul",{parent:t,className:"list-undo"}),this.el.appendChild(t)},l.listUndo=[],l.listRedo=[],l.redo=function(t){if(Number.isInteger(t)||(t=0),this.listRedo[t])for(var e=t+1;e>0;--e)this.listRedo[0].execute()},l.undo=function(t){if(Number.isInteger(t)||(t=0),this.listUndo[t])for(var e=t+1;e>0;--e)this.listUndo[0].execute()},l.removeAllRedo=function(t){t=t||this.listRedo.length-1;for(var e=t+1;e>0;--e)this.removeRedo(0)},l.removeRedo=function(t){if(this.listRedo[t]){this.listRedo[t].remove(),this.listRedo.splice(t,1);for(var e=t;e<this.listRedo.length;e++)this.listRedo[e].setIndex(e)}},l.removeUndo=function(t){if(this.listUndo[t]){this.listUndo[t].remove(),this.listUndo.splice(t,1);for(var e=t;e<this.listUndo.length;e++)this.listUndo[e].setIndex(e)}},l.addRedo=function(t){this.listRedo[t.index]?(t.changeEl(this.listRedo[t.index].el),this.listRedo[t.index].newEl(),this.addRedo(this.listRedo[t.index].setIndex(t.index+1)),this.listRedo[t.index]=t):this.listRedo[t.index]=t.init(this.elRedo)},l.addUndo=function(t,e){this.listUndo[t.index]?(t.changeEl(this.listUndo[t.index].el),this.listUndo[t.index].newEl(),this.addUndo(this.listUndo[t.index].setIndex(t.index+1),e),this.listUndo[t.index]=t):(e||this.removeAllRedo(),this.listUndo[t.index]=t.init(this.elUndo),Editor.getGeneralColors(),Editor.getTransparentColor())},t.exports=l},function(t,e,i){"use strict";var n=i(23),s=i(57),a=n.SNAP,o=(n.FLOAT,n.B,n.L,n.R,n.TL),r=(n.TR,n.BL,n.BR,i(22)),h=i(24),l=i(49),c=r("button",{className:"add-frame"},"add frame"),d=new n("Frames",a,new h(0,0),100,100,o,!0),p=0;d.mainInit=function(){this.list=new l("frames",[],15),r([this.el,c,this.list.el]),$(c).on("click.add",this.createFrame.bind(this))},d.$add=function(){Editor.addPanel(this,i(50))},d.createFrame=function(){this.sprite.addFrame()},d.changeFrame=function(t,e,i){},d.deletePreview=function(t){this.list.remove(t)},d.paintFrame=function(t){this.list.elements[t].paint()},d.addFrame=function(){console.info("addFrame"),this.sprite.addFrame()},d.selectFrame=function(t){},d.addPreview=function(t){this.list.add(new s(t,t.index==p,this.list),t.index)},d.reAppend=function(){},d.resizeFrame=function(t){this.list.elements[t].resize()},t.exports=d},function(t,e,i){"use strict";function n(t,e,i){this.$type="li",s.call(this,"preview-frame"),this.frame=t,this.selected=e,this.list=i,this.background=r("canvas",{parent:this.el}).getContext("2d"),this.context=r("canvas",{parent:this.el}).getContext("2d"),this.spanIndex=r("span",{parent:this.el,className:"index"},this.frame.index+1),this.btnClone=r("button",{parent:this.el,className:"btn btn-clone"},"C"),this.btnHidden=r("button",{parent:this.el,className:"btn btn-hidden"},"H"),this.btnDelete=r("button",{parent:this.el,className:"btn btn-delete"},"D"),e&&this.el.classList.add("active"),$(this.el).on("click.frame",this.onClick.bind(this)),$(this.btnDelete).on("click.frame",this.deleteFrame.bind(this)),$(this.btnClone).on("click.frame",this.cloneFrame.bind(this))}var s=i(9),a=i(12),o=a.TRANSPARENT_IMG,r=i(22),h=i(10),l=h.inheritanceObject,c=h.imageSmoothingDisabled,d=h.defineGetter;l(n,s),d(n.prototype,"index",function(){return this.frame.index}),n.prototype.onClick=function(t){this.frame.select()},n.prototype.cloneFrame=function(t){t.stopPropagation(),this.frame.sprite.addFrame(this.frame.index)},n.prototype.setIndex=function(t){this.frame.sprite.moveFrame(this.index,t)},n.prototype.deleteFrame=function(t){t.stopPropagation(),this.frame["delete"]()},n.prototype.selectFrame=function(){this.selected=!0,this.el.classList.add("active")},n.prototype.unSelectFrame=function(){this.selected=!1,this.el.classList.remove("active")},n.prototype.resize=function(){var t=this.el.clientWidth;this.el.style.height=t+"px",this.el.style.width=t+"px",this.frame.width>this.frame.height?(this.background.canvas.width=this.context.canvas.width=t,this.scale=t/this.frame.width,this.background.canvas.height=this.context.canvas.height=this.frame.height*this.scale,this.background.canvas.style.marginTop=this.context.canvas.style.marginTop=(t-this.background.canvas.height)/2+"px"):(this.background.canvas.height=this.context.canvas.height=t,this.scale=t/this.frame.height,this.background.canvas.width=this.context.canvas.width=this.frame.width*this.scale,this.background.canvas.style.marginLeft=this.context.canvas.style.marginLeft=(t-this.background.canvas.width)/2+"px"),this.paintBackground(),this.paint()},n.prototype.paintBackground=function(){var t=this.background.createPattern(o,"repeat");this.background.rect(0,0,this.background.canvas.width,this.background.canvas.height),this.background.fillStyle=t,this.background.fill()},n.prototype.appendTo=function(t){return t.appendChild(this.el),this.resize(),this.el.classList.remove("active"),this.spanIndex.textContent=this.frame.index+1,this},n.prototype.updateIndex=function(){this.spanIndex.textContent=this.frame.index+1},n.prototype.paint=function(){this.clean(),c(this.context),this.context.drawImage(this.frame.context.canvas,0,0,this.frame.width,this.frame.height,0,0,this.context.canvas.width,this.context.canvas.height)},n.prototype.clean=function(){this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height)},t.exports=n},function(t,e,i){"use strict";var n=i(12),s=n.TRANSPARENT_COLOR,a=(n.PALETTE,i(12).palette.CHANGE_COLOR,i(22)),o=i(23),r=i(26),h=i(24),l=(i(33),i(59)),c=new o("Palette",o.SNAP,new h(100,60),15,20,o.R);c.mainInit=function(){var t=this,e=a(["div",{parent:this.el,className:"content-tools"}]);this.addButton=a(["button",{parent:e,className:"btn add-button"},"+"]),this.optionsButton=a(["button",{parent:e,className:"btn option-button"},"="]),this.editButton=a(["button",{parent:e,className:"btn edit-button"},"/"]),this.palette=l.currentColorsPalette,this.setPalette(l.currentColorsPalette),r.setPrimaryColor("rgba(0, 0, 0, 1)"),r.setSecudaryColor(s),$(this.addButton).on("click.add",this.onClickAddButton.bind(this)),$(this.editButton).on("click.edit",this.onClickEditButton.bind(this)),$(this.optionsButton).on("click.add",function(){l.changePalette(t.palette,t.setPalette.bind(t))})},c.onClickEditButton=function(t){console.log("click")},c.onClickAddButton=function(t){this.palette.addColor()},c.setCurretColors=function(t){l.currentColorsPalette.setColors(t.array)},c.getCurrentColors=function(){return currentColors},c.setPalette=function(){var t=arguments.length<=0||void 0===arguments[0]?this.palette:arguments[0],e=t==l.currentColorsPalette;this.editButton.disabled=e,this.addButton.disabled=e,this.palette.remove(),this.palette=t.appendTo(this.el)},t.exports=c},function(t,e,i){"use strict";var n=i(23),s=i(24),a=i(22),o=(i(54),i(55),i(60)),r=n.createFloatPanel("Palettes",new s(window.innerWidth/2-100,100),!0),h=[{id:1,name:"Default Colors",colors:["rgba(26, 188, 156, 1)","rgba(241, 196, 15, 1)","rgba(52, 152, 219, 1)","rgba(230, 126, 34, 1)","rgba(231, 76, 60, 1)","rgba(189, 195, 199, 1)","rgba(155, 89, 182, 1)","rgba(52, 73, 94, 1)","rgba(127, 140, 141, 1)"]}];r.currentColorsPalette=new o(0,"Current Colors"),r.mainInit=function(){this.el.style.width="400px",this.el.style.height="200px",this.list=a(["div",{parent:this.el,className:"content-palettes"}]),$(a("button",{parent:this.el},"ok")).on("click.ok",this.ok.bind(this)),$(a("button",{parent:this.el},"cancel")).on("click.cancal",this.cancel.bind(this))},r.onShow=function(){var t=this;this.list.innerHTML="";var e=new o(this.currentColorsPalette.id,this.currentColorsPalette.name,this.currentColorsPalette.colors);e.appendTo(this.list).on("click.select",function(){t.selectPalette.removeClass("active"),e.addClass("active"),t.selectPalette=t.currentColorsPalette}),this.currentColorsPalette.id==this.current.id&&(this.selectPalette=e.addClass("active"));for(var i=function(e){var i=new o(h[e].id,h[e].name,h[e].colors);i.appendTo(t.list).on("click.select",function(){t.selectPalette.removeClass("active"),t.selectPalette=i.addClass("active")}),i.id==t.current.id&&(t.selectPalette=i,i.addClass("active"))},n=0;n<h.length;n++)i(n)},r.ok=function(){this.currentColorsPalette.id==this.selectPalette.id&&(this.selectPalette=this.currentColorsPalette),this.callbackChange&&this.callbackChange(this.selectPalette),this.hide()},r.cancel=function(){this.hide()},r.changePalette=function(t,e){console.log(t),this.current=t,this.callbackChange=e,this.show()},t.exports=r},function(t,e,i){"use strict";function n(t){var e=arguments.length<=1||void 0===arguments[1]?"unnamed":arguments[1],i=arguments.length<=2||void 0===arguments[2]?[]:arguments[2],n=arguments.length<=3||void 0===arguments[3]?!1:arguments[3];s.call(this,"palette",e.toLowerCase().replace(/ /,"-")),this.id=t,this.name=e||"unnamed",this.colors=i,this.offEvents=n,this.generateColors()}var s=i(9),a=i(30),o=(i(22),i(33));a(n,s),n.prototype.generateColors=function(){this.el.innerHTML="";for(var t=0;t<this.colors.length;t++){var e=new o(this.colors[t],void 0,void 0,this.offEvents);e.appendTo(this.el)}},n.prototype.setColors=function(){var t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];this.colors=t,this.generateColors()},n.prototype.addColor=function(){var t=arguments.length<=0||void 0===arguments[0]?"rgba(0, 0, 0, 1)":arguments[0];this.colors.push(t),this.generateColors()},t.exports=n},function(t,e,i){"use strict";function n(t){s.call(this),this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[];for(var e in h)h.hasOwnProperty(e)&&(h[e]=void 0===t[e]?h[e]:t[e]);this.setOptions(h)}var s=i(62).EventEmitter,a=i(10).browser,o=i(10).inheritanceObject,r=i(63),h={workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,preserveColors:!1},l={delay:500,copy:!1,transparent:null};o(n,s),n.prototype.setOption=function(t,e){this.options[t]=e,null==this._canvas||"width"!==t&&"height"!==t||(this._canvas[t]=e)},n.prototype.setOptions=function(t){for(var e in t)t.hasOwnProperty(e)&&this.setOption(e,t[e])},n.prototype.addFrame=function(t,e){var i={transparent:this.options.transparent};e=e||{};for(var n in l)i[n]=e[n]||l[n];if(this.options.width||this.setOption("width",t.width),this.options.height||this.setOption("height",t.height),t instanceof ImageData)i.data=t.data;else if(t instanceof CanvasRenderingContext2D||t instanceof WebGLRenderingContext)e.copy?i.data=this.getContextData(t):i.context=t;else{if(t.childNodes)throw new Error("Invalid image");e.copy?i.data=this.getImageData(t):i.image=t}this.frames.push(i)},n.prototype.render=function(){var t=void 0;if(this.running)throw new Error("Already running");if(!this.options.width||!this.options.height)throw new Error("Width and height must be set prior to rendering");this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=this.frames.map(function(){return null}),t=this.spawnWorkers();for(var e=0;t>e;e++)this.renderNextFrame();this.emit("start"),this.emit("progress",0)},n.prototype.abort=function(){for(var t;;){if(t=this.activeWorkers.shift(),!t)break;console.log("killing active worker"),t.terminate()}this.running=!1,this.emit("abort")},n.prototype.spawnWorkers=function(){for(var t=Math.min(this.options.workers,this.frames.length),e=void 0,i=Math.abs(t-this.freeWorkers.length),n=this,s=0;i>s;s++)e=r(),e.onmessage=function(t){n.activeWorkers.splice(n.activeWorkers.indexOf(e),1),n.freeWorkers.push(e),n.frameFinished(t.data),console.log(t.data)},this.freeWorkers.push(e);return t},n.prototype.frameFinished=function(t){console.log("frame "+t.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[t.index]=t,this.imageParts.indexOf(null)>=0?this.renderNextFrame():this.finishRendering()},n.prototype.finishRendering=function(){for(var t=0,e=void 0,i=void 0,n=0,s=void 0,a=0;a<this.imageParts.length;a++)e=this.imageParts[a],t+=(e.data.length-1)*e.pageSize+e.cursor;t+=e.pageSize-e.cursor,console.log("rendering finished - filesize "+Math.round(t/1e3)+"kb"),i=new Uint8Array(t);for(var o=0;o<this.imageParts.length;o++){e=this.imageParts[o];for(var r=0;r<e.data.length;r++)s=e.data[r],i.set(s,n),n+=r===e.data.length-1?e.cursor:e.pageSize}this.emit("finished",new Blob([i],{type:"image/gif"}),i)},n.prototype.renderNextFrame=function(){var t=void 0,e=void 0,i=void 0;if(0===this.freeWorkers.length)throw new Error("No free workers");
this.nextFrame>=this.frames.length||(t=this.frames[this.nextFrame++],i=this.freeWorkers.shift(),e=this.getTask(t),console.log("starting frame "+(e.index+1)+" of "+this.frames.length),this.activeWorkers.push(i),i.postMessage(e))},n.prototype.getContextData=function(t){return t.getImageData(0,0,this.options.width,this.options.height).data},n.prototype.getImageData=function(t){var e=void 0;return this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),e=this._canvas.getContext("2d"),e.setFill=this.options.background,e.fillRect(0,0,this.options.width,this.options.height),e.drawImage(t,0,0),this.getContextData(e)},n.prototype.getTask=function(t){var e=void 0,i=void 0;if(e=this.frames.indexOf(t),i={index:e,last:e===this.frames.length-1,delay:t.delay,transparent:t.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,preserveColors:this.options.preserveColors,repeat:this.options.repeat,canTransfer:"chrome"===a.name},null!=t.data)i.data=t.data;else if(null!=t.context)i.data=this.getContextData(t.context);else{if(null==t.image)throw new Error("Invalid frame");i.data=this.getImageData(t.image)}return i},t.exports=n},function(t,e){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function s(t){return"number"==typeof t}function a(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(t){if(!s(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},i.prototype.emit=function(t){var e,i,s,r,h,l;if(this._events||(this._events={}),"error"===t&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(i=this._events[t],o(i))return!1;if(n(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),i.apply(this,r)}else if(a(i))for(r=Array.prototype.slice.call(arguments,1),l=i.slice(),s=l.length,h=0;s>h;h++)l[h].apply(this,r);return!0},i.prototype.addListener=function(t,e){var s;if(!n(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?a(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,a(this._events[t])&&!this._events[t].warned&&(s=o(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,s&&s>0&&this._events[t].length>s&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){function i(){this.removeListener(t,i),s||(s=!0,e.apply(this,arguments))}if(!n(e))throw TypeError("listener must be a function");var s=!1;return i.listener=e,this.on(t,i),this},i.prototype.removeListener=function(t,e){var i,s,o,r;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(i=this._events[t],o=i.length,s=-1,i===e||n(i.listener)&&i.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(a(i)){for(r=o;r-- >0;)if(i[r]===e||i[r].listener&&i[r].listener===e){s=r;break}if(0>s)return this;1===i.length?(i.length=0,delete this._events[t]):i.splice(s,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},i.prototype.removeAllListeners=function(t){var e,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[t],n(i))this.removeListener(t,i);else if(i)for(;i.length;)this.removeListener(t,i[i.length-1]);return delete this._events[t],this},i.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},i.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},i.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,i){"use strict";t.exports=function(){return new Worker(i.p+"/workers/gif.js")}},function(t,e,i){"use strict";t.exports=function(){return new Worker(i.p+"/workers/colors.js")}},function(t,e){"use strict";t.exports={init:function(){$(window).on("keydown.shortcuts",this.onKeydown.bind(this)),$(window).on("keyup.shortcuts",this.onKeyup.bind(this))},onKeydown:function(t){t.keyCode?t.keyCode:t.which;console.log(t.ctrlKey,t.code)},onKeyup:function(t){}}},function(t,e){"use strict";t.exports={}},function(t,e,i){"use strict";var n=i(23),s=i(24),a=n.SNAP,o=(n.FLOAT,n.B,n.L,n.R),r=(n.TL,n.TR,n.BL,n.BR,i(12).events.CHANGE_SPRITE,new n("Info",a,new s(100,80),15,20,o));r.mainInit=function(){},r.changeSprite=function(t){var e=document.createElement("div");e.textContent="Width: "+t.width,this.el.appendChild(e),e=document.createElement("div"),e.textContent="Height: "+t.height,this.el.appendChild(e),e=document.createElement("div"),e.textContent="Frames: "+t.frames.length,this.el.appendChild(e)},t.exports=r},function(t,e,i){"use strict";var n=i(23),s=i(10),a=s.make,o=(i(24),i(12).events.SELECT_TOOL,i(12)),r=(o.WIDTH_DEF,o.HEIGHT_DEF),h=n.createModalPanel("NewProject");h.mainInit=function(){this.el.style["z-index"]="10",this.body=a("div",{parent:this.el,className:"body"}),this.body.style.width="300px",this.body.style.height="400px",this.inputWidth=a("input",{parent:a("div",{parent:this.body},a("label","width")),type:"number",value:r}),this.inputHeight=a("input",{parent:a("div",{parent:this.body},a("label","height")),type:"number",value:r}),$(a("button",{parent:this.body},"Create Project")).on("click.new",this.onCreateProject.bind(this))},h.onCreateProject=function(){Editor.initSprite({width:Number(this.inputWidth.value),height:Number(this.inputHeight.value)}),this.hide()},t.exports=h},function(t,e,i){"use strict";var n=i(23),s=i(24),a=i(10),o=a.make,r=i(54),h=i(55),l=n.createFloatPanel("Resize",new s(window.innerWidth/2-100,100),!0);l.mainInit=function(){var t=this,e=void 0;this.el.style["z-index"]="10",this.body=o("div",{parent:this.el,className:"body"}),this.body.style.width="200px",this.inputWidth=o("input",{parent:o("div",{parent:this.body},o("label","width:")),type:"number"}),this.inputHeight=o("input",{parent:o("div",{parent:this.body},o("label","height:")),type:"number"}),this.checkContentResize=o("input",{parent:o("div",{parent:this.body},o("label","Resize content")),type:"checkbox"}),e=o("div",{parent:this.body,className:"resize-grid"}),this.anchor={x:0,y:0},this.gridCells=[];for(var i=function(i){for(var n=function(n){var s=t.anchor.x==n&&t.anchor.y==i,a=t,r=void 0;t.gridCells[n]=t.gridCells[n]||[],t.gridCells[n][i]=r=o("div",{parent:e,className:"resize-cell "+(s?"active":"")},o("span"),o("span"),o("span"),o("span")),$(r).on("click.select",function(t){a.gridCells[a.anchor.x][a.anchor.y].classList.remove("active"),this.classList.add("active"),a.anchor.x=n,a.anchor.y=i,console.log(n,i)})[0]},s=0;3>s;s++)n(s)},n=0;3>n;n++)i(n);$(o("button",{parent:this.body},"Ok")).on("click.new",this.onResize.bind(this)),$(o("button",{parent:this.body},"Cancel")).on("click.cancel",this.hide.bind(this))},l.onShow=function(){this.inputHeight.value=Editor.sprite.height,this.inputWidth.value=Editor.sprite.width},l.onResize=function(t){var e=0,i=0,n=void 0,s=void 0,a=void 0;this.hide(),1==this.anchor.x?e=Math.round((this.inputWidth.value-Editor.sprite.width)/2):2==this.anchor.x&&(e=this.inputWidth.value-Editor.sprite.width),1==this.anchor.y?i=Math.round((this.inputHeight.value-Editor.sprite.height)/2):2==this.anchor.y&&(i=this.inputHeight.value-Editor.sprite.height),s=Editor.sprite.width,a=Editor.sprite.height,n=Editor.sprite.frames.map(function(t){return t.layers.map(function(t){return t.imageData})}),h.addUndo(new r(r.RESIZE,{sprite:Editor.sprite,data:n,width:s,height:a},0)),Editor.sprite.resize(Number(this.inputWidth.value),Number(this.inputHeight.value),this.checkContentResize.checked,e,i),Editor.canvas.center()},t.exports=l},function(t,e,i){"use strict";var n=i(23),s=i(24),a=i(10),o=a.make,r=(i(54),i(55),n.createFloatPanel("BackgroundLayer",new s(window.innerWidth/2-100,100),!0));r.mainInit=function(){this.el.style["z-index"]="10",this.body=o("div",{parent:this.el,className:"body"}),this.body.style.width="200px",this.inputImage=o("input",{parent:o("div",{parent:this.body},o("label","Image: ")),type:"file"}),this.preview=o("canvas",{parent:this.body}).getContext("2d"),$(this.inputImage).on("change.input",this.onInputImage.bind(this))},r.onShow=function(){Editor.canvas.artboard.layer.background?this.preview.canvas.style.display="block":this.preview.canvas.style.display="none",this.preview.canvas.width=8*Editor.sprite.height,this.preview.canvas.height=8*Editor.sprite.width},r.onInputImage=function(t){function e(){this.preview.drawImage(i,0,0,200,200),this.preview.canvas.style.display="block"}var i=new Image;i.onload=e.bind(this),i.src=URL.createObjectURL(t.target.files[0])},t.exports=r},function(t,e,i){"use strict";var n=i(72),s=i(12),a=s.RIGHT_CLICK,o=(s.LEFT_CLICK,s.TRANSPARENT_COLOR),r=(s.actions,i(26)),h=i(55),l=(i(24),i(54)),c=new n("bucket"),d=void 0,p=void 0;c.active=function(){this.layer.saveImageData()},c.onMouseDown=function(t){if("CANVAS"==t.target.nodeName){this.layer.saveImageData(),this.layer.saveStatus();var e=this.canvas.calculatePosition(t.clientX,t.clientY);d=t.which===a?r.getSecondColor():r.getPrimaryColor(),p=this.layer.getColorPixel(e),p&&d!==p&&(this.fill(e,d,p,d==o?"fillCleanAt":"fillAt"),this.layer.paint(),h.addUndo(new l(l.PAINT,{layer:this.layer,data:this.layer.prevStatus},0)))}},c.onMouseMove=function(t){},c.onMouseUp=function(t){this.layer.saveImageData()},t.exports=function(){return Editor.addTool(c)}},function(t,e,i){"use strict";function n(t){this.$type="button",s.call(this,"tool"),this.name=t,this.el.textContent=this.name[0],this.stroke=[],this.el.addEventListener("click",this.select.bind(this))}var s=i(9),a=(i(24),i(26)),o=Math.abs,r=i(12),h=(r.TRANSPARENT_COLOR,i(12).events.SELECT_TOOL,i(29)),l=h.getRGBAComponents,c=i(10),d=c.inheritanceObject,p=c.defineGetter;d(n,s),p(n.prototype,"canvas",function(){return Editor.canvas}),p(n.prototype,"layer",function(){return Editor.canvas.artboard.layer}),n.prototype.onMouseUp=function(){},n.prototype.onMouseMove=function(){},n.prototype.onMouseDown=function(){},n.prototype.addPixelStroke=function(t){t&&this.stroke.push(t)},n.prototype.select=function(){a.changeCurrentTool(this.name)},n.prototype.clonePixel=function(t){return{cord:t.cord.clone(),color:t.color}},n.prototype.active=function(){},n.prototype.getRectangle=function(t,e,i,n,s,a){var o=i>t?1:-1,r=n>e?1:-1,h=Math.abs(t-i),l=Math.abs(e-n),c=t,d=e;for(Editor.canvas.cleanPrev();h>0;)h--,this.layer[a]({x:c,y:e},s),this.layer[a]({x:c,y:n},s),c+=o;for(this.layer[a]({x:c,y:e},s),this.layer[a]({x:c,y:n},s);l>0;)l--,d+=r,this.layer[a]({x:t,y:d},s),this.layer[a]({x:i,y:d},s)},n.prototype.fill=function(t,e,i,n){var s=[t],a=void 0,o=void 0,r=4*(this.layer.width*this.layer.height),h=0,c=[-1,0,1,0],d=[0,1,0,-1],p=l(e),u=l(i);if(this.layer.isSameColor(t.x,t.y,u,p)){for(;s.length;){a=s.pop(),this.layer[n]({x:a.x,y:a.y},e);for(var f=0;4>f;f++)o={x:a.x+d[f],y:a.y+c[f]},this.layer.isSameColor(o.x,o.y,u,p)&&s.push(o);if(h>r)break;h++}Editor.canvas.paintMain()}},n.prototype.lineBetween=function(t,e,i,n,s,a){for(var r,h=o(i-t),l=o(n-e),c=i>t?1:-1,d=n>e?1:-1,p=h-l;t!==i||e!==n;)this.layer[a]({x:t,y:e},s),r=2*p,r>-l&&(p-=l,t+=c),h>r&&(p+=h,e+=d);this.layer[a]({x:t,y:e},s)},t.exports=n},function(t,e,i){"use strict";var n=i(72),s=Math.abs,a=i(12),o=(a.RIGHT_CLICK,a.LEFT_CLICK,a.TRANSPARENT_COLOR),r=a.actions,h=(i(24),i(54)),l=i(55),c=i(47),d=new n("eraser"),p=void 0;d.onMouseDown=function(t){"CANVAS"==t.target.nodeName&&(this.clicked=!0,p=this.canvas.calculatePosition(t.clientX,t.clientY),$(window).on("mouseup.up",this.onMouseUp.bind(this)),$(window).on("mouseout.leave",this.onMouseLeave.bind(this)))},d.onMouseLeave=function(t){var e=t.toElement||t.relatedTarget;if(e===document.children[0]){var i=this.canvas.calculatePosition(t.clientX,t.clientY);p=i}},d.onMouseMove=function(t){if(this.clicked){var e=this.canvas.calculatePosition(t.clientX,t.clientY);(this.layer.validCord(e)||this.layer.validCord(p))&&(s(p.y-e.y)>1||s(p.x-e.x)>1?this.lineBetween(p.x,p.y,e.x,e.y,o,"cleanAt"):this.stroke[e.x][e.y]||o===this.layer.getColorPixel(e)||(this.stroke[e.x][e.y]=this.layer.cleanAt({x:e.x,y:e.y},o))),p=e}},d.onMouseUp=function(t){if($(window).off("mouseup.up"),$(window).off("mouseout.leave"),this.clicked){this.clicked=!1;var e=this.canvas.calculatePosition(t.clientX,t.clientY);this.stroke[e.x][e.y]||o===this.layer.getColorPixel(e)||(this.stroke[e.x][e.y]=this.layer[at]({x:e.x,y:e.y},color)),p=void 0,c.paintLayer(this.layer.index),this.layer.paint(),l.addUndo(new h(r.PAINT,{layer:this.layer,stroke:this.stroke},0))}},t.exports=function(){return Editor.addTool(d)}},function(t,e,i){"use strict";var n=i(72),s=i(12),a=s.RIGHT_CLICK,o=(s.LEFT_CLICK,s.TRANSPARENT_COLOR,i(24),i(26)),r=new n("pick");r.onMouseDown=function(t){if("CANVAS"==t.target.nodeName){var e=this.canvas.calculatePosition(t.clientX,t.clientY);e.color=this.layer.getColorPixel(e),t.which===a?o.setSecudaryColor(e.color):o.setPrimaryColor(e.color),o.lastTool.select()}},t.exports=function(){return Editor.addTool(r)}},function(t,e,i){"use strict";var n=i(72),s=i(12),a=s.RIGHT_CLICK,o=(s.LEFT_CLICK,s.TRANSPARENT_COLOR),r=(i(24),i(54)),h=i(55),l=i(12).actions,c=i(26),d=new n("rectangle"),p=void 0,u=void 0,f=void 0,v=void 0;d.onMouseDown=function(t){"CANVAS"==t.target.nodeName&&(this.layer.saveStatus(),this.clicked=!0,p=this.canvas.calculatePosition(t.clientX,t.clientY),f=t.which===a?c.getSecondColor():c.getPrimaryColor(),v="paintPrevAt",$(window).off("mouseup.upCanvas").on("mouseup.upCanvas",this.onMouseUp.bind(this)),$(window).off("mouseout.leaveCanvas").on("mouseout.leaveCanvas",this.onMouseLeave.bind(this)),$(window).off("mousemove.moveCanvas").on("mousemove.moveCanvas",this.onMouseMove.bind(this)))},d.onMouseLeave=function(t){var e=t.toElement||t.relatedTarget;if(e===document.children[0]){var i=this.canvas.calculatePosition(t.clientX,t.clientY);u=i}},d.onMouseMove=function(t){u=this.canvas.calculatePosition(t.clientX,t.clientY),(p.x!=u.x||p.y!=u.y)&&this.getRectangle(p.x,p.y,u.x,u.y,f,v)},d.onMouseUp=function(t){$(window).off("mouseup.upCanvas"),$(window).off("mouseout.leaveCanvas"),$(window).off("mousemove.moveCanvas"),v=f==o?"cleanAt":"paintAt",this.clicked=!0,u=this.canvas.calculatePosition(t.clientX,t.clientY),this.getRectangle(p.x,p.y,u.x,u.y,f,v),this.layer.paint(),h.addUndo(new r(l.PAINT,{layer:this.layer,data:this.layer.prevStatus},0))},t.exports=function(){return Editor.addTool(d)}},function(t,e,i){"use strict";var n=i(72),s=i(12),a=s.RIGHT_CLICK,o=(s.LEFT_CLICK,s.TRANSPARENT_COLOR),r=(i(24),i(26)),h=i(54),l=i(12).actions,c=i(55),d=new n("line"),p=void 0,u=void 0,f=void 0,v=void 0;d.onMouseDown=function(t){if("CANVAS"==t.target.nodeName){this.clicked=!0,this.layer.saveStatus(),this.stroke=new Array(this.layer.width);for(var e=0;e<this.stroke.length;e++)this.stroke[e]=[];p=this.canvas.calculatePosition(t.clientX,t.clientY),f=t.which===a?r.getSecondColor():r.getPrimaryColor(),v="paintPrevAt",$(window).off("mouseup.upCanvas").on("mouseup.upCanvas",this.onMouseUp.bind(this)),$(window).off("mouseout.leaveCanvas").on("mouseout.leaveCanvas",this.onMouseLeave.bind(this)),$(window).off("mousemove.moveCanvas").on("mousemove.moveCanvas",this.onMouseMove.bind(this))}},d.onMouseLeave=function(t){var e=t.toElement||t.relatedTarget;if(e===document.children[0]){var i=this.canvas.calculatePosition(t.clientX,t.clientY);u=i}},d.onMouseMove=function(t){if(u=this.canvas.calculatePosition(t.clientX,t.clientY),p.x!=u.x||p.y!=u.y){Editor.canvas.cleanPrev();for(var e=0;e<this.stroke.length;e++)this.stroke[e]=[];this.lineBetween(p.x,p.y,u.x,u.y,f,v)}},d.onMouseUp=function(t){$(window).off("mouseup.upCanvas"),$(window).off("mouseout.leaveCanvas"),$(window).off("mousemove.moveCanvas"),v=f==o?"cleanAt":"paintAt",u=this.canvas.calculatePosition(t.clientX,t.clientY);for(var e=0;e<this.stroke.length;e++)this.stroke[e]=[];this.lineBetween(p.x,p.y,u.x,u.y,f,v),c.addUndo(new h(l.PAINT,{layer:this.layer,data:this.layer.prevStatus},0)),this.layer.paint()},t.exports=function(){return Editor.addTool(d)}},function(t,e,i){"use strict";var n=i(72),s=i(12),a=(s.RIGHT_CLICK,s.LEFT_CLICK,s.TRANSPARENT_COLOR,i(24),i(54),i(55),i(12).actions,i(26),new n("select")),o=void 0,r=void 0;a.onMouseDown=function(t){"CANVAS"==t.target.nodeName&&(this.layer.saveStatus(),o=this.canvas.calculatePosition(t.clientX,t.clientY),$(window).off("mouseup.upCanvas").on("mouseup.upCanvas",this.onMouseUp.bind(this)),$(window).off("mouseout.leaveCanvas").on("mouseout.leaveCanvas",this.onMouseLeave.bind(this)),$(window).off("mousemove.moveCanvas").on("mousemove.moveCanvas",this.onMouseMove.bind(this)))},a.onMouseLeave=function(t){var e=t.toElement||t.relatedTarget;if(e===document.children[0]){var i=this.canvas.calculatePosition(t.clientX,t.clientY);r=i}},a.onMouseMove=function(t){r=this.canvas.calculatePosition(t.clientX,t.clientY),r.x+=r.x>=o.x?1:0,r.y+=r.y>=o.y?1:0,(o.x!=r.x||o.y!=r.y)&&this.layer.prevSelect(o.x,o.y,r.x-o.x,r.y-o.y)},a.onMouseUp=function(t){$(window).off("mouseup.upCanvas"),$(window).off("mouseout.leaveCanvas"),$(window).off("mousemove.moveCanvas"),r=this.canvas.calculatePosition(t.clientX,t.clientY),r.x+=r.x>=o.x?1:0,r.y+=r.y>=o.y?1:0,(Math.abs(r.x-o.x)>1||Math.abs(r.y-o.y)>1)&&this.layer.getSelect(o.x,o.y,r.x-o.x,r.y-o.y)},t.exports=function(){return Editor.addTool(a)}},function(t,e,i){"use strict";var n=i(72),s=i(12),a=(s.MIDDLE_CLICK,s.RIGHT_CLICK),o=(s.LEFT_CLICK,s.TRANSPARENT_COLOR),r=Math.abs,h=i(26),l=i(55),c=(i(47),i(12).actions),d=i(54),p=(i(24),new n("pencil")),u=void 0,f=void 0,v=void 0;p.onMouseDown=function(t){"CANVAS"==t.target.nodeName&&(this.layer.saveStatus(),this.clicked=!0,u=this.canvas.calculatePosition(t.clientX,t.clientY),f=t.which===a?h.getSecondColor():h.getPrimaryColor(),v=f==o?"cleanAt":"paintAt",$(window).off("mouseup.upCanvas").on("mouseup.upCanvas",this.onMouseUp.bind(this)),$(window).off("mouseout.leaveCanvas").on("mouseout.leaveCanvas",this.onMouseLeave.bind(this)),$(window).off("mousemove.moveCanvas").on("mousemove.moveCanvas",this.onMouseMove.bind(this)))},p.onMouseLeave=function(t){var e=t.toElement||t.relatedTarget;if(e===document.children[0]){var i=this.canvas.calculatePosition(t.clientX,t.clientY);u=i}},p.onMouseMove=function(t){if(this.clicked){var e=this.canvas.calculatePosition(t.clientX,t.clientY);(this.layer.validCord(e)||this.layer.validCord(u))&&(r(u.y-e.y)>1||r(u.x-e.x)>1?this.lineBetween(u.x,u.y,e.x,e.y,f,v):this.layer[v]({x:e.x,y:e.y},f)),u=e}},p.onMouseUp=function(t){if($(window).off("mouseup.upCanvas"),$(window).off("mouseout.leaveCanvas"),$(window).off("mousemove.moveCanvas"),this.clicked){this.clicked=!1;var e=this.canvas.calculatePosition(t.clientX,t.clientY);this.layer[v]({x:e.x,y:e.y},f),u=void 0,this.layer.paint(),l.addUndo(new d(c.PAINT,{layer:this.layer,data:this.layer.prevStatus},0))}},t.exports=function(){return Editor.addTool(p)}}]);